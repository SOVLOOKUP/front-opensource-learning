# å›¾å¯è§†å‰ç«¯åº”ç”¨ä¹‹å°è¯•ç‰›åˆ€

é˜…è¯»è¯¥æ•™ç¨‹ä¸éœ€è¦ä½ é¢„å…ˆæŒæ¡ä»»ä½• React çŸ¥è¯†ã€‚

### è¯¾å‰å‡†å¤‡

æˆ‘ä»¬å°†ä¼šåœ¨è¿™ä¸ªæ•™ç¨‹ä¸­å¼€å‘ä¸€ä¸ªç®€å•çš„å›¾å¯è§†åˆ†æwebappã€‚ä½ å°†åœ¨è¯¥æ•™ç¨‹ä¸­å­¦åˆ°å…³äºæ„å»º React åº”ç”¨çš„åŸºç¡€çŸ¥è¯†ï¼ŒæŒæ¡è¿™äº›çŸ¥è¯†åï¼Œä½ å°†ä¼šå¯¹å‰ç«¯å¼€å‘æœ‰æ›´åŠ æ·±åˆ»çš„ç†è§£ã€‚

> æç¤º
>
> è¿™ç¯‡æ•™ç¨‹é€‚ç”¨äºæ›´å–œæ¬¢**è¾¹å­¦è¾¹åš**çš„å¼€å‘è€…ï¼Œå¦‚æœä½ æ›´å–œæ¬¢ä»å¤´å¼€å§‹å­¦ä¹ ä¸€äº›æ¦‚å¿µï¼Œè¯·å‚è€ƒ[é€æ­¥å­¦ä¹ æŒ‡å—](https://zh-hans.reactjs.org/docs/hello-world.html)ã€‚ä½ ä¼šå‘ç°è¿™ç¯‡æ•™ç¨‹å’Œé€æ­¥å­¦ä¹ æŒ‡å—æ˜¯äº’è¡¥çš„ã€‚

è¿™ç¯‡æ•™ç¨‹åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼šã€todoï¼šurlã€‘

- ç¯å¢ƒå‡†å¤‡æ˜¯å­¦ä¹ è¯¥æ•™ç¨‹çš„**èµ·ç‚¹**ã€‚
- æ¦‚è§ˆä»‹ç»äº† React çš„**åŸºç¡€çŸ¥è¯†**ï¼šç»„ä»¶ã€props å’Œ stateã€‚
- æ¸¸æˆå®Œå–„ä»‹ç»äº†åœ¨ React å¼€å‘è¿‡ç¨‹ä¸­æœ€å¸¸ç”¨çš„æŠ€æœ¯ã€‚
- æ—¶é—´æ—…è¡Œå¯ä»¥è®©ä½ æ›´åŠ æ·±åˆ»åœ°äº†è§£ React çš„ç‹¬ç‰¹ä¼˜åŠ¿ã€‚

ä½ ä¸å¿…ç€æ€¥ä¸€å£æ°”å­¦å®Œè¿™ç¯‡æ•™ç¨‹çš„æ‰€æœ‰å†…å®¹ï¼Œå°½åŠ›å°±è¡Œï¼Œå“ªæ€•æ˜¯å…ˆå­¦ä¹ ä¸€ä¸¤èŠ‚ã€‚

### æˆ‘ä»¬ä¼šåšå‡ºä»€ä¹ˆä¸œè¥¿ï¼Ÿ

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·ç”¨ React å¼€å‘ä¸€ä¸ªç®€å•çš„å›¾å¯è§†åˆ†æwebappã€‚

ä½ å¯ä»¥æå‰é¢„è§ˆæˆ‘ä»¬è¦å†™çš„webappçš„**[æœ€ç»ˆæ•ˆæœ]()**ã€‚å¦‚æœä½ çœ‹ä¸æ‡‚å…¶ä¸­çš„ä»£ç ï¼Œæˆ–ä¸ç†Ÿæ‚‰è¿™äº›è¯­æ³•ï¼Œåˆ«æ‹…å¿ƒï¼æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¼šä¸€æ­¥ä¸€æ­¥å¸®åŠ©ä½ ç†è§£ React åŠå…¶è¯­æ³•ã€‚

### å‰ç½®çŸ¥è¯†

ä½ åº”è¯¥å·²ç»åœ¨å‰ç½®è¯¾ç¨‹ä¸­å¯¹ HTML å’Œ JavaScript æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚å³ä¾¿ä½ ä¹‹å‰ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œä½ ä¹Ÿå¯ä»¥è·Ÿä¸Šè¿™ç¯‡æ•™ç¨‹çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å‡å®šä½ ä¹Ÿå·²ç»ç†Ÿæ‚‰äº†ä¸€äº›ç¼–ç¨‹çš„æ¦‚å¿µï¼Œä¾‹å¦‚ï¼Œå‡½æ•°ã€å¯¹è±¡ã€æ•°ç»„ï¼Œä»¥åŠ class çš„ä¸€äº›å†…å®¹ã€‚

å¦‚æœä½ æƒ³å›é¡¾ä¸€ä¸‹ JavaScriptï¼Œæœ‰æ—¶é—´çš„è¯ä½ å¯ä»¥é˜…è¯»[è¿™ç¯‡æ•™ç¨‹](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/A_re-introduction_to_JavaScript)ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ä¹Ÿç”¨åˆ°äº†ä¸€äº› ES6ï¼ˆè¾ƒæ–°çš„ JavaScript ç‰ˆæœ¬ï¼‰çš„ç‰¹æ€§ã€‚åœ¨è¿™ç¯‡æ•™ç¨‹é‡Œï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨äº†[ç®­å¤´å‡½æ•°ï¼ˆarrow functionsï¼‰](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions)ã€[class](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes)ã€[let](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/let) è¯­å¥å’Œ [const](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/const) è¯­å¥ã€‚

## ç¯å¢ƒå‡†å¤‡

ä½ åº”è¯¥åœ¨å‰ç½®è¯¾ç¨‹å°±å·²ç»æ­å»ºå¥½äº†å‰ç«¯æœ¬åœ°ç¼–ç¨‹ç¯å¢ƒï¼Œæ‰“å¼€ä½ çš„VScodeå§ï¼ï¼ï¼ğŸ’ªğŸ»

### å¯»æ±‚å¸®åŠ©

å¦‚æœä½ é‡åˆ°äº†ä»»ä½•å›°éš¾ï¼Œå¯ä»¥åœ¨ç»„é˜Ÿå­¦ä¹ ç¾¤ä¸­æå‡ºé—®é¢˜ï¼ŒåŒå­¦å’ŒåŠ©æ•™éƒ½ä¼šçƒ­å¿ƒå›ç­”ï½ğŸ˜˜

## æ¦‚è§ˆ

ä½ å·²ç»å‡†å¤‡å¥½äº†ï¼Œè®©æˆ‘ä»¬å…ˆå¤§è‡´äº†è§£ä¸€ä¸‹ React å§ï¼

### React æ˜¯ä»€ä¹ˆï¼Ÿ

> åŸºäºjsxçš„ç»„ä»¶åŒ–ä¸–ç•Œ

React æ˜¯ä¸€ä¸ªå£°æ˜å¼ï¼Œé«˜æ•ˆä¸”çµæ´»çš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚ä½¿ç”¨ React å¯ä»¥å°†ä¸€äº›ç®€çŸ­ã€ç‹¬ç«‹çš„ä»£ç ç‰‡æ®µç»„åˆæˆå¤æ‚çš„ UI ç•Œé¢ï¼Œè¿™äº›ä»£ç ç‰‡æ®µè¢«ç§°ä½œ â€œ**ç»„ä»¶**â€ã€‚

React ä¸­æ‹¥æœ‰å¤šç§ä¸åŒç±»å‹çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å…ˆä» `React.Component` çš„å­ç±»å¼€å§‹ä»‹ç»ï¼š

```
class ShoppingList extends React.Component {
  render() {
    return (
      <div className="shopping-list">
        <h1>Shopping List for {this.props.name}</h1>
        <ul>
          <li>Instagram</li>
          <li>WhatsApp</li>
          <li>Oculus</li>
        </ul>
      </div>
    );
  }
}

// ç”¨æ³•ç¤ºä¾‹: <ShoppingList name="Mark" />
```

æˆ‘ä»¬é©¬ä¸Šä¼šè®¨è®ºè¿™äº›åˆå¥‡æ€ªã€åˆåƒ XML çš„æ ‡ç­¾ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ç»„ä»¶æ¥å‘Šè¯‰ React æˆ‘ä»¬å¸Œæœ›åœ¨å±å¹•ä¸Šçœ‹åˆ°ä»€ä¹ˆã€‚å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒReact ä¼šé«˜æ•ˆåœ°æ›´æ–°å¹¶é‡æ–°æ¸²æŸ“æˆ‘ä»¬çš„ç»„ä»¶ã€‚

å…¶ä¸­ï¼Œ`ShoppingList` æ˜¯ä¸€ä¸ª **React ç»„ä»¶ç±»**ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ª **React ç»„ä»¶ç±»å‹**ã€‚ä¸€ä¸ªç»„ä»¶æ¥æ”¶ä¸€äº›å‚æ•°ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å‚æ•°å«åš `props`ï¼ˆâ€œpropsâ€ æ˜¯ â€œpropertiesâ€ ç®€å†™ï¼‰ï¼Œç„¶åé€šè¿‡ `render` æ–¹æ³•è¿”å›éœ€è¦å±•ç¤ºåœ¨å±å¹•ä¸Šçš„è§†å›¾çš„å±‚æ¬¡ç»“æ„ã€‚

`render` æ–¹æ³•çš„è¿”å›å€¼*æè¿°*äº†ä½ å¸Œæœ›åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹ã€‚React æ ¹æ®æè¿°ï¼Œç„¶åæŠŠç»“æœå±•ç¤ºå‡ºæ¥ã€‚æ›´å…·ä½“åœ°æ¥è¯´ï¼Œ`render` è¿”å›äº†ä¸€ä¸ª **React å…ƒç´ **ï¼Œè¿™æ˜¯ä¸€ç§å¯¹æ¸²æŸ“å†…å®¹çš„è½»é‡çº§æè¿°ã€‚å¤§å¤šæ•°çš„ React å¼€å‘è€…ä½¿ç”¨äº†ä¸€ç§åä¸º â€œJSXâ€ çš„ç‰¹æ®Šè¯­æ³•ï¼ŒJSX å¯ä»¥è®©ä½ æ›´è½»æ¾åœ°ä¹¦å†™è¿™äº›ç»“æ„ã€‚è¯­æ³• `<div />` ä¼šè¢«ç¼–è¯‘æˆ `React.createElement('div')`ã€‚ä¸Šè¿°çš„ä»£ç ç­‰åŒäºï¼š

```
return React.createElement('div', {className: 'shopping-list'},
  React.createElement('h1', /* ... h1 children ... */),
  React.createElement('ul', /* ... ul children ... */)
);
```

[åœ¨çº¿æŸ¥çœ‹ç¼–è¯‘è¿‡ç¨‹](https://babeljs.io/repl/#?presets=react&code_lz=DwEwlgbgBAxgNgQwM5IHIILYFMC8AiJACwHsAHUsAOwHMBaOMJAFzwD4AoKKYQgRlYDKJclWpQAMoyZQAZsQBOUAN6l5ZJADpKmLAF9gAej4cuwAK5wTXbg1YBJSswTV5mQ7c7XgtgOqEETEgAguTuYFamtgDyMBZmSGFWhhYchuAQrADc7EA)

å¦‚æœä½ å¯¹è¿™ä¸ªæ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œå¯ä»¥æŸ¥é˜… [API æ–‡æ¡£](https://zh-hans.reactjs.org/docs/react-api.html#createelement)äº†è§£æœ‰å…³ `createElement()` æ›´è¯¦ç»†çš„ç”¨æ³•ã€‚ä½†åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šç›´æ¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè€Œæ˜¯ç»§ç»­ä½¿ç”¨ JSXã€‚

åœ¨ JSX ä¸­ä½ å¯ä»¥ä»»æ„ä½¿ç”¨ JavaScript è¡¨è¾¾å¼ï¼Œåªéœ€è¦ç”¨ä¸€ä¸ªå¤§æ‹¬å·æŠŠè¡¨è¾¾å¼æ‹¬èµ·æ¥ã€‚æ¯ä¸€ä¸ª React å…ƒç´ äº‹å®ä¸Šéƒ½æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œä½ å¯ä»¥åœ¨ä½ çš„ç¨‹åºä¸­æŠŠå®ƒå½“ä¿å­˜åœ¨å˜é‡ä¸­æˆ–è€…ä½œä¸ºå‚æ•°ä¼ é€’ã€‚

å‰æ–‡ä¸­çš„ `ShoppingList` ç»„ä»¶åªä¼šæ¸²æŸ“ä¸€äº›å†…ç½®çš„ DOM ç»„ä»¶ï¼Œå¦‚`<div />`ã€`<li />`ç­‰ã€‚ä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ç»„åˆå’Œæ¸²æŸ“è‡ªå®šä¹‰çš„ React ç»„ä»¶ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡ `<ShoppingList />` æ¥è¡¨ç¤ºæ•´ä¸ªè´­ç‰©æ¸…å•ç»„ä»¶ã€‚æ¯ä¸ªç»„ä»¶éƒ½æ˜¯å°è£…å¥½çš„ï¼Œå¹¶ä¸”å¯ä»¥å•ç‹¬è¿è¡Œï¼Œè¿™æ ·ä½ å°±å¯ä»¥é€šè¿‡ç»„åˆç®€å•çš„ç»„ä»¶æ¥æ„å»ºå¤æ‚çš„ UI ç•Œé¢ã€‚

### é˜…è¯»åˆå§‹ä»£ç 

åœ¨ä½ çš„å·¥ç¨‹æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ `src/pages`æ–‡ä»¶å¤¹ğŸ“ï¼ˆä½ å·²ç»åœ¨å‰é¢çš„[ç¯å¢ƒå‡†å¤‡]()ä¸­åˆ›å»ºè¿‡è¿™ä¸ªæ–‡ä»¶äº†ï¼‰ã€‚

- [ ] ä¿®æ”¹`index.less`æ–‡ä»¶

  > lessæ˜¯cssçš„è¶…é›†ï¼Œå¯ä»¥çœ‹ä½œåŠ å¼ºç‰ˆçš„css
  
  æˆ‘ä»¬è¿™æ¬¡ç»™ä½ æä¾›ç°æˆçš„CSSæ ·å¼ï¼Œå…³äºå¦‚ä½•åˆ©ç”¨æ ·å¼åšå‡ºæ¼‚äº®çš„é¡µé¢æˆ‘ä»¬ä¼šåœ¨æ•™å­¦è®¡åˆ’çš„ç¬¬äºŒç« ç¬¬äºŒæœŸè¯¦è¿°ã€‚

```less
.main {
  padding: 0;
  margin: 0;
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  right: 0;
}

.map {
  position: absolute;
  left: 32px;
  bottom: 27px;
}

.toolbar {
  position: absolute;
  width: 111px;
  height: 44px;
  right: 35px;
  bottom: 27px;
}

```

- [ ] ä¿®æ”¹index.tsxæ–‡ä»¶

  å…ˆå¤åˆ¶ä¸Šå»ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šé€è¡Œè§£é‡Šè¿™äº›ä»£ç ã€‚

```react
import Graphin from '@antv/graphin';
import styles from './index.less';

const data = {
  nodes: [
    {
      id: 'node-0',
      x: 100,
      y: 100,
    },
    {
      id: 'node-1',
      x: 200,
      y: 200,
    },
    {
      id: 'node-2',
      x: 100,
      y: 300,
    },
  ],
  edges: [
    {
      source: 'node-0',
      target: 'node-1',
    },
  ],
};

export default () => {
  return (
    <div className={styles.main}>
      <Graphin data={data} layout={{ type: 'preset' }}>
      </Graphin>
    </div>
  );
};
```

- [ ] å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
â¯ yarn start
yarn run v1.22.10
$ umi dev
Starting the development server...

âœ” Webpack
  Compiled successfully in 9.47s

 DONE  Compiled successfully in 9481ms                                                                     ä¸Šåˆ9:33:18


  App running at:
  - Local:   http://localhost:8000 (copied to clipboard)
  - Network: http://192.168.1.103:8000
```

![image-20210426094142003](./img/appinit.png)

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®æç¤ºçš„URLï¼Œæˆ‘ä»¬å›¾å¯è§†åŒ–åº”ç”¨é›å½¢å°±åœ¨çœ¼å‰å•¦ï½ ä½ å¯ä»¥å°è¯•æ‹–æ‹½èŠ‚ç‚¹ã€ç§»åŠ¨ç”»å¸ƒã€ä½¿ç”¨é¼ æ ‡æ»šè½®æ”¾å¤§ç¼©å°

**ä»£ç è§£é‡Šï¼š**

```react
// å¯¼å…¥graphinåº“
import Graphin from '@antv/graphin';
// å¯¼å…¥æ ·å¼
import styles from './index.less';

// è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„æ•°æ®
// å…¶ä¸­æœ‰ä¸‰ä¸ªnodeï¼Œä¸€ä¸ªlinkï¼Œä¸ç”»å¸ƒä¸Šçš„èŠ‚ç‚¹å’Œè¾¹å¯¹åº”
const data = {
  nodes: [
    {
      id: 'node-0',
      x: 100,
      y: 100,
    },
    {
      id: 'node-1',
      x: 200,
      y: 200,
    },
    {
      id: 'node-2',
      x: 100,
      y: 300,
    },
  ],
  edges: [
    {
      source: 'node-0',
      target: 'node-1',
    },
  ],
};

// è¿™é‡Œæ˜¯å¯¼å‡ºçš„é¡µé¢ç»„ä»¶
export default () => {
  return (
    // react ä¸­æ˜¯ä½¿ç”¨classNameå­—æ®µæ¥å’Œstyleç»‘å®šçš„ï¼Œæˆ‘ä»¬çš„Graphinç»„ä»¶æ”¾åœ¨è¿™ä¸ªdivç›’å­é‡Œï¼Œç»‘å®šçš„styleè®©è¿™ä¸ªdivç›’å­å……æ»¡å±å¹•
    <div className={styles.main}>
      {/*  åœ¨ç»„ä»¶ä¸Šå¯ä»¥è‡ªå®šä¹‰ç»„ä»¶æš´éœ²çš„propå±æ€§ è¿™é‡Œæˆ‘ä»¬æŠŠéœ€è¦å¯è§†åŒ–çš„æ•°æ®ä¼ å…¥ï¼Œå¹¶ä¸”å®šä¹‰äº†layoutå¸ƒå±€ï¼Œè‡ªé€‚åº”ç”»å¸ƒå¤§å° */}
      <Graphin data={data} layout={{ type: 'preset' }}  fitView={true} >
      </Graphin>
    </div>
  );
};
```

Graphinç»„ä»¶å…¶ä»–propè®¾ç½®å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°ï¼šhttps://graphin.antv.vision/graphin/quick-start/interface

### é€šè¿‡ Props ä¼ é€’æ•°æ®

åœ¨Reacté™¤äº†æ¨å´‡ **ç»„ä»¶åŒ–** æ€ç»´ï¼Œæ•°æ®ä¹Ÿæ¨å´‡ **è‡ªä¸Šè€Œä¸‹** çš„æµåŠ¨

è®©æˆ‘ä»¬è¯•è¯•æ°´ï¼Œå°è¯•ä¿®æ”¹ä¸Šä¸€æ­¥çš„dataæ•°æ®ï¼Œçœ‹çœ‹ Graphin ç»„ä»¶ä¼šäº§ç”Ÿä»€ä¹ˆå˜åŒ–ã€‚

æˆ‘ä»¬ä»ç°åœ¨å¼€å§‹å¼ºçƒˆå»ºè®®ä½ åŠ¨æ‰‹ç¼–å†™ä»¥ä¸‹çš„ä»£ç ï¼Œä¸è¦ä½¿ç”¨å¤åˆ¶/ç²˜è´´ã€‚è¿™å°†åŠ æ·±ä½ å¯¹ React çš„è®°å¿†å’Œç†è§£ã€‚

æˆ‘ä»¬å°†ä»£ç æ”¹å†™æˆä¸‹é¢è¿™æ ·ï¼Œå†æ·»åŠ ä¸€ä¸ª node åˆ° data æ•°æ®ä¸­ï¼š

```react
...
const data = {
  nodes: [
    {
      id: 'node-0',
      x: 100,
      y: 100,
    },
    {
      id: 'node-1',
      x: 200,
      y: 200,
    },
    {
      id: 'node-2',
      x: 100,
      y: 300,
    },
    // begin---
    {
      id: 'node-3',
      x: 200,
      y: 400,
    }
    // end---
  ],
  edges: [
    {
      source: 'node-0',
      target: 'node-1',
    },
  ],
};
...
```

å¯ä»¥çœ‹åˆ°ï¼Œé¡µé¢ç«‹é©¬å¤šå‡ºäº†ä¸€ä¸ªnodeï¼Œä½ å¯ä»¥éšæ—¶æ›´æ”¹æ•°æ®ï¼ŒUIå±‚éƒ½ä¼šåŒæ­¥æ›´æ–°æ˜¾ç¤º

![image-20210426100217448](./img/appadd.png)

æˆ‘ä»¬å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£ğŸ“„ï¼Œä¿®æ”¹èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§ï¼šhttps://graphin.antv.vision/graphin/render/data

ä¸‹é¢æˆ‘ä»¬å°±æ ¹æ®è¿™ä¸ªæ–‡æ¡£ä¿®æ”¹æˆ‘ä»¬çš„dataï¼Œæ¥å±•ç¤ºä¸€ä¸‹è¿™å‡ ä¸ªèŠ‚ç‚¹çš„åå­—å§ï½

```react
...
const data = {
  nodes: [
    {
      id: 'node-0',
      style: {
        label: { value: 'èŠ‚ç‚¹0' },
      },
      x: 100,
      y: 100,
    },
    {
      id: 'node-1',
      style: {
        label: { value: 'èŠ‚ç‚¹1' },
      },
      x: 200,
      y: 200,
    },
    {
      id: 'node-2',/home/sovlookup/æ¡Œé¢/front-opensource-learning/contents/Part-1/å‰ç«¯å…¥é—¨
      style: {
        label: { value: 'èŠ‚ç‚¹2' },
      },
      x: 100,
      y: 300,
    },
    {
      id: 'node-3',
      style: {
        label: { value: 'èŠ‚ç‚¹3' },
      },
      x: 200,
      y: 400,
    },
  ],
  edges: [
    {
      source: 'node-0',
      target: 'node-1',
    },
  ],
};
...
```

![image-20210426184622867](./img/nodename.png)

æ­å–œä½ ï¼ä½ åˆšåˆšæˆåŠŸåœ°æŒæ¡äº†å¦‚ä½•æ§åˆ¶ç»„ä»¶ä¸­çš„æ•°æ®çš„ä»»åŠ¡ï¼Œå®Œæˆäº†ä¸€ä¸ªå›¾å¯è§†åŒ–demoã€‚åœ¨ React åº”ç”¨ä¸­ï¼Œæ•°æ®é€šè¿‡ props çš„ä¼ é€’ï¼Œä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ã€‚

### ä¸°å¯Œåº”ç”¨ç•Œé¢ä¸äº¤äº’

è§‰å¾—è¿™æ ·çš„æ•ˆæœå¤ªå•è°ƒäº†ï¼Ÿæˆ‘ä»¬æ¥ä¸°å¯Œä¸€ä¸‹åº”ç”¨çš„ç•Œé¢å§ï½

Graphinæä¾›äº†å¾ˆå¤šç°æˆçš„é¡µé¢å·¥å…·è¿™æ¬¡æˆ‘ä»¬ä¼šä¸ºä½ å‡†å¤‡ æ”¾å¤§é•œğŸ”ã€å°åœ°å›¾ã€å·¥å…·æ ã€å¸ƒå±€é€‰æ‹©å™¨è¿™å››ä¸ªå·¥å…·ï¼Œæœ€ç»ˆç»“æœæ˜¯è¿™ä¸ªæ ·å­ï¼š

![image-20210426204011556](./img/ui.png)

å‡†å¤‡å¥½äº†å—ï¼Ÿæˆ‘ä»¬å¼€å§‹å§ï½

#### å°åœ°å›¾ç»„ä»¶

- [ ] **é¦–å…ˆæ›´æ–°å¼•å…¥**
è¿™é‡Œæˆ‘ä»¬æŠŠä¹‹åéœ€è¦ç”¨çš„åŒ…ä¸€èµ·å¯¼å…¥äº†ï¼Œè‡ªå·±ä½¿ç”¨çš„æ—¶å€™æŒ‰éœ€å¯¼å…¥å³å¯

```react
import Graphin, { GraphinContextType } from '@antv/graphin';
import {
  MiniMap,
  Toolbar,
  ContextMenu,
  FishEye,
  LayoutSelector 
} from '@antv/graphin-components';
import { ZoomOutOutlined, ZoomInOutlined } from '@ant-design/icons';
import { ToolBarItemType } from '@antv/graphin-components/lib/Toolbar';
import styles from './index.less';
import { useState } from 'react';
import DemoLayoutSelector from './LayoutSelector/LayoutSelectorDemo';
const { Menu } = ContextMenu;
```

- [ ] **åœ¨Graphinæ ‡ç­¾ä¸­æ·»åŠ MiniMapå°åœ°å›¾ç»„ä»¶**

```react
...
<Graphin data={data} fitView={true}>
    {/* å°åœ°å›¾ */}
    <div className={styles.map}>
      <MiniMap visible={true} />
    </div>
<Graphin />
...
```

å®Œæˆï½ å‰ç«¯æœ‰ç€ä¸€ç§ **ç»„ä»¶åµŒå¥— å±‚å±‚å å ** çš„æ„Ÿè§‰

#### å·¥å…·æ ç»„ä»¶

- [ ] **å®šä¹‰äº‹ä»¶**

```react
export default () => {
  // å‚è€ƒtoolbaræ–‡æ¡£é…ç½®çš„optionsï¼Œè‡ªå®šä¹‰toolbarä¸Šæœ‰å“ªäº›æŒ‰é’®
  const options = [
    {
      key: 'zoomOut',
      name: (
        <span>
          æ”¾å¤§ <ZoomInOutlined />
        </span>
      ),
      icon: <ZoomInOutlined />,
    },
    {
      key: 'zoomIn',
      name: <ZoomOutOutlined />,
    },
  ];

  // è¿™æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå‚æ•°ä¸ºcontext(graphinçš„ä¸Šä¸‹æ–‡å¯¹è±¡)ä¸option(ç‚¹å‡»äº‹ä»¶)ï¼Œå½“æˆ‘å°†å…¶ç»‘å®šåˆ°toolbaræ ‡ç­¾ä¸Šï¼Œæ¯æ¬¡å¯¹toolbarçš„ç‚¹å‡»éƒ½ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°
  const toolbarClick = (
    context: GraphinContextType,
    option: ToolBarItemType,
  ) => {
    // åœ¨ä¸Šä¸‹æ–‡å¯¹è±¡ä¸Šæ‹¿å‡ºæˆ‘éœ€è¦çš„åŠŸèƒ½
    const { apis } = context;
    const { handleZoomIn, handleZoomOut } = apis;
     
    // æ ¹æ®ä¼ å…¥çš„optionäº‹ä»¶åˆ¤æ–­ç‚¹å‡»çš„æ˜¯å“ªä¸ªæŒ‰é’®ï¼Œåšå‡ºç›¸åº”çš„è¡Œä¸º
    if (option.key === 'zoomIn') {
      handleZoomIn();
    } else if (option.key === 'zoomOut') {
      handleZoomOut();
    }
  };
...

}
```

- [ ] **äº‹ä»¶ä¸UIç»‘å®š**

```react
...
<Graphin data={data} fitView={true}>
    {/* å·¥å…·æ  */}
    <div className={styles.toolbar}>
      <Toolbar options={options} onChange={toolbarClick} />
    </div>
<Graphin />
...
```

å®Œæˆï½ äº¤äº’å°±æ˜¯ **åœ¨UIç»„ä»¶ä¸ŠæŒ‚ä¸Šå‡½æ•°é’©å­**

#### æ”¾å¤§é•œç»„ä»¶

æˆ‘ä»¬éœ€è¦æŒ‰escé”®éšæ—¶å¯åŠ¨å…³é—­æ”¾å¤§é•œï¼Œé‚£ä¹ˆè¿™åˆæ€ä¹ˆåšåˆ°å‘¢ï¼Ÿé™¤äº†å¼€å…³çš„äº¤äº’ï¼Œè‚¯å®šéœ€è¦ä¸€ä¸ªåœ°æ–¹æ¥å‚¨å­˜æ”¾å¤§é•œçš„å¼€å¯å…³é—­çš„çŠ¶æ€ã€‚

 - [ ] **React Hook**

React Hook ä½œä¸ºä¸€ç§æ•°æ®çŠ¶æ€ç®¡ç†æ–¹å¼ï¼Œä½¿ç”¨èµ·æ¥ååˆ†è½»ä¾¿ã€‚

```react
export default () => {
    // æ–°å»ºä¸€ä¸ªçŠ¶æ€ç®¡ç†å™¨ï¼Œfalseä¸ºå®ƒçš„åˆå§‹å€¼ï¼Œvisibleä¸ºè¿™ä¸ªçŠ¶æ€å˜é‡ï¼ŒsetVisibleæ˜¯ç”¨äºæ”¹å˜è¿™ä¸ªå˜é‡çš„å‡½æ•°
    const [visible, setVisible] = useState(false);
    
    // æ¯æ¬¡è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šæ‰“å¼€/å…³é—­æ”¾å¤§é•œï¼Œæ‰€ä»¥å®ƒå°±åƒä¸€ä¸ªå¼€å…³ä¸€æ ·
    const menuClick = () => {
        setVisible(!visible);
    };
...
}
```

å’¦ï¼Ÿä¸å¯¹å‘€ï¼Œæˆ‘ä»¬æƒ³è¦æ”¹å˜visibleè¿™ä¸ªå˜é‡ç›´æ¥ç”¨ `=` èµ‹å€¼ä¸å°±è¡Œäº†ï¼Ÿ

å…¶å®ä¸ç„¶ï¼Œä½ åœ¨è°ƒç”¨ `setVisible` çš„æ—¶å€™ï¼ŒReact ä¼šå¸®ä½  **é‡æ–°æ¸²æŸ“ä¸æ•°æ®æ”¹åŠ¨æœ‰å…³çš„ç»„ä»¶** ï¼Œè¿™æ ·UIæ‰ä¼šæ›´æ–°ã€‚

ä½ ä¼šç”¨äº†å—ï¼Ÿ

- [ ] **æ·»åŠ ç»„ä»¶**

å°† â€å¼€å…³â€œ å‡½æ•°ç»‘å®šåˆ°ESCé”®ä¸Š

```
...
<Graphin data={data} fitView={true}>
    {/* æ”¾å¤§é•œ */}
    <FishEye options={{}} visible={visible} handleEscListener={menuClick} />
<Graphin />
...
```

ç°åœ¨ï¼Œå›åˆ°æµè§ˆå™¨ä¸­ï¼ŒæŒ‰ä¸€æŒ‰ä½ çš„ESCé”®çœ‹çœ‹å‘¢ï¼Ÿæ˜¯ä¸æ˜¯æœ‰æ”¾å¤§é•œè¹¦å‡ºæ¥å•¦ï¼Ÿ

#### å¸ƒå±€é€‰æ‹©å™¨ç»„ä»¶

åœ¨è¿™ä¸€å…³ï¼Œæˆ‘ä»¬æä¾›ç»™ä½ ç°æˆçš„ â€œå¸ƒå±€é€‰æ‹©å™¨â€ ç»„ä»¶ï¼Œä½ éœ€è¦åœ¨ä½ çš„çˆ¶ç»„ä»¶é‡Œå¼•å…¥å­ â€œå¸ƒå±€é€‰æ‹©å™¨â€ ç»„ä»¶ï¼Œå¹¶ä¸ä½ çš„æ•°æ®å®Œæˆç»‘å®šã€‚

- [ ] **ä»–å±±ä¹‹çŸ³ï¼Œå¯ä»¥æ”»ç‰**



æœ€åç»™å‡ºæ€»ä½“ä»£ç ï¼Œæœ€åå¢åŠ äº†ä¸€ä¸ªå³é”®èœå•ç»„ä»¶ï¼Œä½ èƒ½çœ‹æ‡‚å—ï¼Ÿ

```react
import Graphin, { GraphinContextType } from '@antv/graphin';
import {
  MiniMap,
  Toolbar,
  ContextMenu,
  FishEye,
  LayoutSelector 
} from '@antv/graphin-components';
import { ZoomOutOutlined, ZoomInOutlined } from '@ant-design/icons';
import { ToolBarItemType } from '@antv/graphin-components/lib/Toolbar';
import styles from './index.less';
import { useState } from 'react';
import DemoLayoutSelector from './LayoutSelector/LayoutSelectorDemo';
const { Menu } = ContextMenu;

const defaultLayout = {
  type: 'graphin-force',
  preset: {
    type: 'concentric',
  },
  animation: true,
};

const data = {
  nodes: [
    {
      id: 'node-0',
      style: {
        label: { value: 'èŠ‚ç‚¹0' },
      },
      x: 100,
      y: 100,
    },
    {
      id: 'node-1',
      style: {
        label: { value: 'èŠ‚ç‚¹1' },
      },
      x: 200,
      y: 200,
    },
    {
      id: 'node-2',
      style: {
        label: { value: 'èŠ‚ç‚¹2' },
      },
      x: 100,
      y: 300,
    },
    {
      id: 'node-3',
      style: {
        label: { value: 'èŠ‚ç‚¹3' },
      },
      x: 200,
      y: 400,
    },
  ],
  edges: [
    {
      source: 'node-0',
      target: 'node-1',
    },
  ],
};

// è¿™é‡Œæ˜¯å¯¼å‡ºçš„é¡µé¢çˆ¶ç»„ä»¶
export default () => {
  const [visible, setVisible] = useState(false);
  const [state, setState] = useState({
    layout: { ...defaultLayout, animation: false },
    data,
  });

  const options = [
    {
      key: 'zoomOut',
      name: (
        <span>
          æ”¾å¤§ <ZoomInOutlined />
        </span>
      ),
      icon: <ZoomInOutlined />,
    },
    {
      key: 'zoomIn',
      name: <ZoomOutOutlined />,
    },
  ];

  const updateLayout = (previousType: string, type: string) => {
    setState({
      layout: { ...defaultLayout, type },
      data,
    });
  };

  const toolbarClick = (
    context: GraphinContextType,
    option: ToolBarItemType,
  ) => {
    const { apis } = context;
    const { handleZoomIn, handleZoomOut } = apis;
    if (option.key === 'zoomIn') {
      handleZoomIn();
    } else if (option.key === 'zoomOut') {
      handleZoomOut();
    }
  };

  const menuClick = () => {
    setVisible(!visible);
  };

  return (
    <div className={styles.main}>
      {/*  åœ¨ç»„ä»¶ä¸Šå¯ä»¥è‡ªå®šä¹‰ç»„ä»¶æš´éœ²çš„propå±æ€§ è¿™é‡Œæˆ‘ä»¬æŠŠéœ€è¦å¯è§†åŒ–çš„æ•°æ®ä¼ å…¥ï¼Œå¹¶ä¸”å®šä¹‰äº†layoutå¸ƒå±€ï¼Œè‡ªé€‚åº”ç”»å¸ƒå¤§å° */}
      <Graphin data={state.data} layout={state.layout} fitView={true}>
        {/* å°åœ°å›¾ */}
        <div className={styles.map}>
          <MiniMap visible={true} />
        </div>

        {/* å·¥å…·æ  */}
        <div className={styles.toolbar}>
          <Toolbar options={options} onChange={toolbarClick} />
        </div>

        {/* å³é”®èœå• */}
        <ContextMenu bindType="canvas">
          <Menu bindType="canvas">
            <Menu.Item onClick={menuClick}>å¼€å¯æ”¾å¤§é•œğŸ”</Menu.Item>
          </Menu>
        </ContextMenu>

        {/* æ”¾å¤§é•œ */}
        <FishEye options={{}} visible={visible} handleEscListener={menuClick} />

        {/* å¸ƒå±€é€‰æ‹©å™¨ */}
        <LayoutSelector>
          <DemoLayoutSelector updateLayout={updateLayout} />
        </LayoutSelector>
      </Graphin>
    </div>
  );
};
```
### åˆ†ç¦»æ•°æ®ä¸UIå±‚





### æ·»åŠ æ•°æ®æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½



### ç»™ç»„ä»¶æ·»åŠ äº¤äº’åŠŸèƒ½

æ¥ä¸‹æ¥æˆ‘ä»¬è¯•ç€è®©æ£‹ç›˜çš„æ¯ä¸€ä¸ªæ ¼å­åœ¨ç‚¹å‡»ä¹‹åèƒ½è½ä¸‹ä¸€é¢— â€œXâ€ ä½œä¸ºæ£‹å­ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠ Square ç»„ä»¶ä¸­ `render()` æ–¹æ³•çš„è¿”å›å€¼ä¸­çš„ button æ ‡ç­¾ä¿®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š

```
class Square extends React.Component {
  render() {
    return (
      <button className="square" onClick={function() { alert('click'); }}>        {this.props.value}
      </button>
    );
  }
}
```

å¦‚æœæ­¤åˆ»ç‚¹å‡»æŸä¸ªæ ¼å­ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºæç¤ºæ¡†ã€‚

> æ³¨æ„
>
> ä¸ºäº†å°‘è¾“å…¥ä»£ç ï¼ŒåŒæ—¶ä¸ºäº†é¿å… [`this` é€ æˆçš„å›°æ‰°](https://yehudakatz.com/2011/08/11/understanding-javascript-function-invocation-and-this/)ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨[ç®­å¤´å‡½æ•°](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions) æ¥è¿›è¡Œäº‹ä»¶å¤„ç†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
>
> ```
> class Square extends React.Component {
>  render() {
>    return (
>      <button className="square" onClick={() => alert('click')}>       {this.props.value}
>      </button>
>    );
>  }
> }
> ```
>
> æ³¨æ„ï¼šæ­¤å¤„ä½¿ç”¨äº† `onClick={() => alert('click')}` çš„æ–¹å¼å‘ `onClick` è¿™ä¸ª prop ä¼ å…¥ä¸€ä¸ª*å‡½æ•°*ã€‚ React å°†åœ¨å•å‡»æ—¶è°ƒç”¨æ­¤å‡½æ•°ã€‚ä½†å¾ˆå¤šäººç»å¸¸å¿˜è®°ç¼–å†™ `() =>`ï¼Œè€Œå†™æˆäº† `onClick={alert('click')}`ï¼Œè¿™ç§å¸¸è§çš„é”™è¯¯ä¼šå¯¼è‡´æ¯æ¬¡è¿™ä¸ªç»„ä»¶æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šè§¦å‘å¼¹å‡ºæ¡†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¸Œæœ› Square ç»„ä»¶å¯ä»¥â€œè®°ä½â€å®ƒè¢«ç‚¹å‡»è¿‡ï¼Œç„¶åç”¨ â€œXâ€ æ¥å¡«å……å¯¹åº”çš„æ–¹æ ¼ã€‚æˆ‘ä»¬ç”¨ **state** æ¥å®ç°æ‰€è°“â€œè®°å¿†â€çš„åŠŸèƒ½ã€‚

å¯ä»¥é€šè¿‡åœ¨ React ç»„ä»¶çš„æ„é€ å‡½æ•°ä¸­è®¾ç½® `this.state` æ¥åˆå§‹åŒ– stateã€‚`this.state` åº”è¯¥è¢«è§†ä¸ºä¸€ä¸ªç»„ä»¶çš„ç§æœ‰å±æ€§ã€‚æˆ‘ä»¬åœ¨ `this.state` ä¸­å­˜å‚¨å½“å‰æ¯ä¸ªæ–¹æ ¼ï¼ˆSquareï¼‰çš„å€¼ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡æ–¹æ ¼è¢«ç‚¹å‡»çš„æ—¶å€™æ”¹å˜è¿™ä¸ªå€¼ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å‘è¿™ä¸ª class ä¸­æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆå§‹åŒ– stateï¼š

```
class Square extends React.Component {
  constructor(props) {    super(props);    this.state = {      value: null,    };  }
  render() {
    return (
      <button className="square" onClick={() => alert('click')}>
        {this.props.value}
      </button>
    );
  }
}
```

> æ³¨æ„
>
> åœ¨ [JavaScript class](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes) ä¸­ï¼Œæ¯æ¬¡ä½ å®šä¹‰å…¶å­ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œéƒ½éœ€è¦è°ƒç”¨ `super` æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨æ‰€æœ‰å«æœ‰æ„é€ å‡½æ•°çš„çš„ React ç»„ä»¶ä¸­ï¼Œæ„é€ å‡½æ•°å¿…é¡»ä»¥ `super(props)` å¼€å¤´ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹ Square ç»„ä»¶çš„ `render` æ–¹æ³•ï¼Œè¿™æ ·ï¼Œæ¯å½“æ–¹æ ¼è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ˜¾ç¤ºå½“å‰ state çš„å€¼äº†ï¼š

- åœ¨ `<button>` æ ‡ç­¾ä¸­ï¼ŒæŠŠ `this.props.value` æ›¿æ¢ä¸º `this.state.value`ã€‚
- å°† `onClick={...}` äº‹ä»¶ç›‘å¬å‡½æ•°æ›¿æ¢ä¸º `onClick={() => this.setState({value: 'X'})}`ã€‚
- ä¸ºäº†æ›´å¥½çš„å¯è¯»æ€§ï¼Œå°† `className` å’Œ `onClick` çš„ prop åˆ†ä¸¤è¡Œä¹¦å†™ã€‚

ä¿®æ”¹ä¹‹åï¼ŒSquare ç»„ä»¶ä¸­ `render` æ–¹æ³•çš„è¿”å›å€¼ä¸­çš„ `<button>` æ ‡ç­¾å°±å˜æˆäº†ä¸‹é¢è¿™æ ·ï¼š

```
class Square extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      value: null,
    };
  }

  render() {
    return (
      <button
        className="square"        onClick={() => this.setState({value: 'X'})}      >
        {this.state.value}      </button>
    );
  }
}
```

åœ¨ Square ç»„ä»¶ `render` æ–¹æ³•ä¸­çš„ `onClick` äº‹ä»¶ç›‘å¬å‡½æ•°ä¸­è°ƒç”¨ `this.setState`ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ¯æ¬¡ `<button>` è¢«ç‚¹å‡»çš„æ—¶å€™é€šçŸ¥ React å»é‡æ–°æ¸²æŸ“ Square ç»„ä»¶ã€‚ç»„ä»¶æ›´æ–°ä¹‹åï¼ŒSquare ç»„ä»¶çš„ `this.state.value` çš„å€¼ä¼šå˜ä¸º `'X'`ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨æ¸¸æˆæ£‹ç›˜ä¸Šå°±èƒ½çœ‹è§ `X` äº†ã€‚ç‚¹å‡»ä»»æ„ä¸€ä¸ªæ–¹æ ¼ï¼Œ`X` å°±ä¼šå‡ºç°äº†ã€‚

æ¯æ¬¡åœ¨ç»„ä»¶ä¸­è°ƒç”¨ `setState` æ—¶ï¼ŒReact éƒ½ä¼šè‡ªåŠ¨æ›´æ–°å…¶å­ç»„ä»¶ã€‚

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/VbbVLg?editors=0010)**

### å¼€å‘è€…å·¥å…·

åœ¨ [Chrome](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en) æˆ–è€… [Firefox](https://addons.mozilla.org/en-US/firefox/addon/react-devtools/) ä¸­å®‰è£…æ‰©å±• React Devtools å¯ä»¥è®©ä½ åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹ React çš„ç»„ä»¶æ ‘ã€‚

[![React Devtools](https://zh-hans.reactjs.org/static/878d91461c78d8f238e116477dfe0b46/e45a9/devtools.png)](https://zh-hans.reactjs.org/static/878d91461c78d8f238e116477dfe0b46/e45a9/devtools.png)

ä½ è¿˜å¯ä»¥åœ¨ React DevTools ä¸­æ£€æŸ¥ React ç»„ä»¶çš„ state å’Œ propsã€‚

å®‰è£… React DevTools ä¹‹åï¼Œå³é”®ç‚¹å‡»é¡µé¢çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åé€‰æ‹©â€œæŸ¥çœ‹â€ï¼Œè¿™æ ·å°±èƒ½æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·äº†ï¼Œå¹¶ä¸”å·¥å…·æ æœ€åä¼šå¤šå±•ç¤ºä¸€ä¸ª React çš„é€‰é¡¹å¡ï¼ˆåŒ…å« â€œâš›ï¸ Componentsâ€ å’Œ â€œâš›ï¸ Profilerâ€ï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨ â€œâš›ï¸ Componentsâ€ æ¥æ£€æŸ¥ç»„ä»¶æ ‘ã€‚

**ä¸è¿‡ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ CodePen åœ¨çº¿ç¼–è¾‘å™¨çš„è¯ï¼Œè¿˜éœ€è¦å‡ æ­¥æ“ä½œæ‰èƒ½æ­£ç¡®ä½¿ç”¨å¼€å‘å·¥å…·**

1. ç™»å½•æˆ–æ³¨å†Œï¼Œç„¶ååœ¨é‚®ä»¶ä¸­ç¡®è®¤ï¼ˆéœ€è¦å…³é—­åƒåœ¾é‚®ä»¶ï¼‰ã€‚
2. ç‚¹å‡» â€œForkâ€ æŒ‰é’®ã€‚
3. ç‚¹å‡» â€œChange Viewâ€ï¼Œç„¶åé€‰æ‹© â€œDebug modeâ€ã€‚
4. ä¸Šä¸€æ­¥ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„æ ‡ç­¾é¡µï¼Œæ­¤æ—¶å¼€å‘è€…å·¥å…·å°±ä¼šæœ‰ä¸€ä¸ª React æ ‡ç­¾äº†ã€‚

## æ¸¸æˆå®Œå–„

æˆ‘ä»¬ç°åœ¨å·²ç»ç¼–å†™å¥½äº†äº•å­—æ£‹æ¸¸æˆä¸­ï¼Œæœ€åŸºç¡€çš„å¯ä»¥è½å­çš„æ£‹ç›˜ã€‚ä¸ºäº†å¼€å‘ä¸€ä¸ªå®Œæ•´çš„æ¸¸æˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦äº¤æ›¿åœ¨æ£‹ç›˜ä¸Šæ”¾ç½® â€œXâ€ å’Œ â€œOâ€ï¼Œå¹¶ä¸”åˆ¤æ–­å‡ºèƒœè€…ã€‚

### çŠ¶æ€æå‡

å½“å‰ï¼Œæ¯ä¸ª Square ç»„ä»¶éƒ½ç»´æŠ¤äº†æ¸¸æˆçš„çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰ 9 ä¸ª Square çš„å€¼æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å‡ºèƒœè€…äº†ã€‚

ä½ å¯èƒ½ä¼šæƒ³ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ£‹ç›˜ Board ç»„ä»¶ä¸­æ”¶é›†æ¯ä¸ªæ ¼å­ Square ç»„ä»¶ä¸­çš„ stateã€‚è™½ç„¶æŠ€æœ¯ä¸Šæ¥è®²æ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯ä»£ç å¦‚æ­¤ç¼–å†™ä¼šè®©äººå¾ˆéš¾ç†è§£ï¼Œå¹¶ä¸”æˆ‘ä»¬ä»¥åæƒ³è¦ç»´æŠ¤é‡æ„æ—¶ä¹Ÿä¼šéå¸¸å›°éš¾ã€‚æ‰€ä»¥ï¼Œæœ€å¥½çš„è§£å†³æ–¹å¼æ˜¯ç›´æ¥å°†æ‰€æœ‰çš„ state çŠ¶æ€æ•°æ®å­˜å‚¨åœ¨ Board çˆ¶ç»„ä»¶å½“ä¸­ã€‚ä¹‹å Board ç»„ä»¶å¯ä»¥å°†è¿™äº›æ•°æ®é€šè¿‡ props ä¼ é€’ç»™å„ä¸ª Square å­ç»„ä»¶ï¼Œ[æ­£å¦‚ä¸Šæ–‡æˆ‘ä»¬æŠŠæ•°å­—ä¼ é€’ç»™æ¯ä¸€ä¸ª Square ä¸€æ ·](https://zh-hans.reactjs.org/tutorial/tutorial.html#passing-data-through-props)ã€‚

**å½“ä½ é‡åˆ°éœ€è¦åŒæ—¶è·å–å¤šä¸ªå­ç»„ä»¶æ•°æ®ï¼Œæˆ–è€…ä¸¤ä¸ªç»„ä»¶ä¹‹é—´éœ€è¦ç›¸äº’é€šè®¯çš„æƒ…å†µæ—¶ï¼Œéœ€è¦æŠŠå­ç»„ä»¶çš„ state æ•°æ®æå‡è‡³å…¶å…±åŒçš„çˆ¶ç»„ä»¶å½“ä¸­ä¿å­˜ã€‚ä¹‹åçˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡ props å°†çŠ¶æ€æ•°æ®ä¼ é€’åˆ°å­ç»„ä»¶å½“ä¸­ã€‚è¿™æ ·åº”ç”¨å½“ä¸­æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€æ•°æ®å°±èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°åŒæ­¥å…±äº«äº†ã€‚**

åƒè¿™ç§å°†ç»„ä»¶çš„ state æå‡åˆ°çˆ¶ç»„ä»¶çš„æƒ…å½¢åœ¨é‡æ„ React ç»„ä»¶æ—¶ç»å¸¸ä¼šé‡åˆ° â€”â€” å€Ÿæ­¤æˆ‘ä»¬æ¥å®è·µä¸€ä¸‹ã€‚

ä¸º Board ç»„ä»¶æ·»åŠ æ„é€ å‡½æ•°ï¼Œå°† Board ç»„ä»¶çš„åˆå§‹çŠ¶æ€è®¾ç½®ä¸ºé•¿åº¦ä¸º 9 çš„ç©ºå€¼æ•°ç»„ï¼š

```
class Board extends React.Component {
  constructor(props) {    super(props);    this.state = {      squares: Array(9).fill(null),    };  }
  renderSquare(i) {
    return <Square value={i} />;
  }
```

å½“æˆ‘ä»¬å¡«å……æ£‹ç›˜åï¼Œ`this.state.squares` æ•°ç»„çš„å€¼å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š

```
[
  'O', null, 'X',
  'X', 'X', 'O',
  'O', null, null,
]
```

Board ç»„ä»¶å½“å‰çš„ `renderSquare` æ–¹æ³•çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š

```
  renderSquare(i) {
    return <Square value={i} />;
  }
```

å¼€å§‹æ—¶ï¼Œæˆ‘ä»¬ä¾æ¬¡ä½¿æŠŠ 0 åˆ° 8 çš„å€¼é€šè¿‡ prop ä» Board [å‘ä¸‹ä¼ é€’](https://zh-hans.reactjs.org/tutorial/tutorial.html#passing-data-through-props)ï¼Œä»è€Œè®©å®ƒä»¬æ˜¾ç¤ºå‡ºæ¥ã€‚ä¸Šä¸€æ­¥ä¸æ­¤ä¸åŒï¼Œæˆ‘ä»¬[æ ¹æ® Square è‡ªå·±å†…éƒ¨çš„ state](https://zh-hans.reactjs.org/tutorial/tutorial.html#making-an-interactive-component)ï¼Œä½¿ç”¨äº† â€œXâ€ æ¥ä»£æ›¿ä¹‹å‰çš„æ•°å­—ã€‚å› æ­¤ï¼ŒSquare å¿½ç•¥äº†å½“å‰ä» Board ä¼ é€’ç»™å®ƒçš„é‚£ä¸ª `value` propã€‚

è®©æˆ‘ä»¬å†ä¸€æ¬¡ä½¿ç”¨ prop çš„ä¼ é€’æœºåˆ¶ã€‚æˆ‘ä»¬é€šè¿‡ä¿®æ”¹ Board æ¥æŒ‡ç¤ºæ¯ä¸€ä¸ª Square çš„å½“å‰å€¼ï¼ˆ`'X'`, `'O'`, æˆ–è€… `null`ï¼‰ã€‚æˆ‘ä»¬åœ¨ Board çš„æ„é€ å‡½æ•°ä¸­å·²ç»å®šä¹‰å¥½äº† `squares` æ•°ç»„ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹ Board çš„ `renderSquare` æ–¹æ³•æ¥è¯»å–è¿™äº›å€¼äº†ã€‚

```
  renderSquare(i) {
    return <Square value={this.state.squares[i]} />;  }
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/gWWQPY?editors=0010)**

è¿™æ ·ï¼Œæ¯ä¸ª Square å°±éƒ½èƒ½æ¥æ”¶åˆ°ä¸€ä¸ª `value` prop äº†ï¼Œè¿™ä¸ª prop çš„å€¼å¯ä»¥æ˜¯ `'X'`ã€ `'O'`ã€ æˆ– `null`ï¼ˆ`null` ä»£è¡¨ç©ºæ–¹æ ¼ï¼‰ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ä¿®æ”¹ä¸€ä¸‹ Square çš„ç‚¹å‡»äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚Board ç»„ä»¶å½“å‰ç»´æŠ¤äº†é‚£äº›å·²ç»è¢«å¡«å……äº†çš„æ–¹æ ¼ã€‚æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è®© Square å»æ›´æ–° Board çš„ stateã€‚ç”±äº state å¯¹äºæ¯ä¸ªç»„ä»¶æ¥è¯´æ˜¯ç§æœ‰çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ç›´æ¥é€šè¿‡ Square æ¥æ›´æ–° Board çš„ stateã€‚

ç›¸åï¼Œä» Board ç»„ä»¶å‘ Square ç»„ä»¶ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œå½“ Square è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°† Board ç»„ä»¶çš„ `renderSquare` æ–¹æ³•æ”¹å†™ä¸ºå¦‚ä¸‹æ•ˆæœï¼š

```
  renderSquare(i) {
    return (
      <Square
        value={this.state.squares[i]}
        onClick={() => this.handleClick(i)}      />
    );
  }
```

> æ³¨æ„
>
> ä¸ºäº†æé«˜å¯è¯»æ€§ï¼Œæˆ‘ä»¬æŠŠè¿”å›çš„ React å…ƒç´ æ‹†åˆ†æˆäº†å¤šè¡Œï¼ŒåŒæ—¶åœ¨æœ€å¤–å±‚åŠ äº†å°æ‹¬å·ï¼Œè¿™æ · JavaScript è§£æçš„æ—¶å€™å°±ä¸ä¼šåœ¨ `return` çš„åé¢è‡ªåŠ¨æ’å…¥ä¸€ä¸ªåˆ†å·ä»è€Œç ´åä»£ç ç»“æ„äº†ã€‚

ç°åœ¨æˆ‘ä»¬ä» Board ç»„ä»¶å‘ Square ç»„ä»¶ä¸­ä¼ é€’ä¸¤ä¸ª props å‚æ•°ï¼š`value` å’Œ `onClick`ã€‚`onClick` prop æ˜¯ä¸€ä¸ª Square ç»„ä»¶ç‚¹å‡»äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ Square çš„ä»£ç ï¼š

- å°† Square ç»„ä»¶çš„ `render` æ–¹æ³•ä¸­çš„ `this.state.value` æ›¿æ¢ä¸º `this.props.value` ã€‚
- å°† Square ç»„ä»¶çš„ `render` æ–¹æ³•ä¸­çš„ `this.setState()` æ›¿æ¢ä¸º `this.props.onClick()` ã€‚
- åˆ æ‰ Square ç»„ä»¶ä¸­çš„æ„é€ å‡½æ•° `constructor`ï¼Œå› ä¸ºè¯¥ç»„ä»¶ä¸éœ€è¦å†ä¿å­˜æ¸¸æˆçš„ stateã€‚

è¿›è¡Œä¸Šè¿°ä¿®æ”¹ä¹‹åï¼Œä»£ç ä¼šå˜æˆä¸‹é¢è¿™æ ·:

```
class Square extends React.Component {  render() {    return (
      <button
        className="square"
        onClick={() => this.props.onClick()}      >
        {this.props.value}      </button>
    );
  }
}
```

æ¯ä¸€ä¸ª Square è¢«ç‚¹å‡»æ—¶ï¼ŒBoard æä¾›çš„ `onClick` å‡½æ•°å°±ä¼šè§¦å‘ã€‚æˆ‘ä»¬å›é¡¾ä¸€ä¸‹è¿™æ˜¯æ€ä¹ˆå®ç°çš„ï¼š

1. å‘ DOM å†…ç½®å…ƒç´  `<button>` æ·»åŠ  `onClick` propï¼Œè®© React å¼€å¯å¯¹ç‚¹å‡»äº‹ä»¶çš„ç›‘å¬ã€‚
2. å½“ button è¢«ç‚¹å‡»æ—¶ï¼ŒReact ä¼šè°ƒç”¨ Square ç»„ä»¶çš„ `render()` æ–¹æ³•ä¸­çš„ `onClick` äº‹ä»¶å¤„ç†å‡½æ•°ã€‚
3. äº‹ä»¶å¤„ç†å‡½æ•°è§¦å‘äº†ä¼ å…¥å…¶ä¸­çš„ `this.props.onClick()` æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”± Board ä¼ é€’ç»™ Square çš„ã€‚
4. ç”±äº Board æŠŠ `onClick={() => this.handleClick(i)}` ä¼ é€’ç»™äº† Squareï¼Œæ‰€ä»¥å½“ Square ä¸­çš„äº‹ä»¶å¤„ç†å‡½æ•°è§¦å‘æ—¶ï¼Œå…¶å®å°±æ˜¯è§¦å‘çš„ Board å½“ä¸­çš„ `this.handleClick(i)` æ–¹æ³•ã€‚
5. ç°åœ¨æˆ‘ä»¬è¿˜å°šæœªå®šä¹‰ `handleClick()` æ–¹æ³•ï¼Œæ‰€ä»¥ä»£ç è¿˜ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚å¦‚æœæ­¤æ—¶ç‚¹å‡» Squareï¼Œä½ ä¼šåœ¨å±å¹•ä¸Šçœ‹åˆ°çº¢è‰²çš„é”™è¯¯æç¤ºï¼Œæç¤ºå†…å®¹ä¸ºï¼šâ€œthis.handleClick is not a functionâ€ã€‚

> æ³¨æ„
>
> å› ä¸º DOM å…ƒç´  `<button>` æ˜¯ä¸€ä¸ªå†…ç½®ç»„ä»¶ï¼Œå› æ­¤å…¶ `onClick` å±æ€§åœ¨ React ä¸­æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚è€Œå¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶æ¥è¯´ï¼Œå‘½åå°±å¯ä»¥ç”±ç”¨æˆ·è‡ªå·±æ¥å®šä¹‰äº†ã€‚æˆ‘ä»¬ç»™ Square çš„ `onClick` å’Œ Board çš„ `handleClick` èµ‹äºˆä»»æ„çš„åç§°ï¼Œä»£ç ä¾æ—§æœ‰æ•ˆã€‚åœ¨ React ä¸­ï¼Œæœ‰ä¸€ä¸ªå‘½åè§„èŒƒï¼Œé€šå¸¸ä¼šå°†ä»£è¡¨äº‹ä»¶çš„ç›‘å¬ prop å‘½åä¸º `on[Event]`ï¼Œå°†å¤„ç†äº‹ä»¶çš„ç›‘å¬æ–¹æ³•å‘½åä¸º `handle[Event]` è¿™æ ·çš„æ ¼å¼ã€‚

è¿™æ—¶å€™æˆ‘ä»¬ç‚¹å‡» Square çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰ `handleClick` æ–¹æ³•ã€‚æˆ‘ä»¬ç°åœ¨æ¥å‘ Board é‡Œæ·»åŠ  `handleClick` æ–¹æ³•ï¼š

```
class Board extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      squares: Array(9).fill(null),
    };
  }

  handleClick(i) {    const squares = this.state.squares.slice();    squares[i] = 'X';    this.setState({squares: squares});  }
  renderSquare(i) {
    return (
      <Square
        value={this.state.squares[i]}
        onClick={() => this.handleClick(i)}
      />
    );
  }

  render() {
    const status = 'Next player: X';

    return (
      <div>
        <div className="status">{status}</div>
        <div className="board-row">
          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
        </div>
        <div className="board-row">
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
        </div>
        <div className="board-row">
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}
        </div>
      </div>
    );
  }
}
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/ybbQJX?editors=0010)**

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç‚¹å‡» Square æ¥å¡«å……é‚£äº›æ–¹æ ¼ï¼Œæ•ˆæœä¸ä¹‹å‰ç›¸åŒã€‚ä½†æ˜¯ï¼Œå½“å‰ state æ²¡æœ‰ä¿å­˜åœ¨å•ä¸ªçš„ Square ç»„ä»¶ä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨äº† Board ç»„ä»¶ä¸­ã€‚æ¯å½“ Board çš„ state å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè¿™äº› Square ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ä¸€æ¬¡ã€‚æŠŠæ‰€æœ‰ Square çš„ state ä¿å­˜åœ¨ Board ç»„ä»¶ä¸­å¯ä»¥è®©æˆ‘ä»¬åœ¨å°†æ¥åˆ¤æ–­å‡ºæ¸¸æˆçš„èƒœè€…ã€‚

å› ä¸º Square ç»„ä»¶ä¸å†æŒæœ‰ stateï¼Œå› æ­¤æ¯æ¬¡å®ƒä»¬è¢«ç‚¹å‡»çš„æ—¶å€™ï¼ŒSquare ç»„ä»¶å°±ä¼šä» Board ç»„ä»¶ä¸­æ¥æ”¶å€¼ï¼Œå¹¶ä¸”é€šçŸ¥ Board ç»„ä»¶ã€‚åœ¨ React æœ¯è¯­ä¸­ï¼Œæˆ‘ä»¬æŠŠç›®å‰çš„ Square ç»„ä»¶ç§°åšâ€œå—æ§ç»„ä»¶â€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒBoard ç»„ä»¶å®Œå…¨æ§åˆ¶äº† Square ç»„ä»¶ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬è°ƒç”¨äº† `.slice()` æ–¹æ³•åˆ›å»ºäº† `squares` æ•°ç»„çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨ç°æœ‰çš„æ•°ç»„ä¸Šè¿›è¡Œä¿®æ”¹ã€‚åœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬ä¼šä»‹ç»ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦åˆ›å»º `square` æ•°ç»„çš„å‰¯æœ¬ã€‚

### ä¸ºä»€ä¹ˆä¸å¯å˜æ€§åœ¨ React ä¸­éå¸¸é‡è¦

åœ¨ä¸Šä¸€èŠ‚å†…å®¹å½“ä¸­ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ `.slice()` å‡½æ•°å¯¹æ•°ç»„è¿›è¡Œæ‹·è´ï¼Œè€Œéç›´æ¥ä¿®æ”¹ç°æœ‰çš„æ•°ç»„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å­¦ä¹ ä¸å¯å˜æ€§ä»¥åŠä¸å¯å˜æ€§çš„é‡è¦æ€§ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸¤ç§æ”¹å˜æ•°æ®çš„æ–¹å¼ã€‚ç¬¬ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥*ä¿®æ”¹*å˜é‡çš„å€¼ï¼Œç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨æ–°çš„ä¸€ä»½æ•°æ®æ›¿æ¢æ—§æ•°æ®ã€‚

#### ç›´æ¥ä¿®æ”¹æ•°æ®

```
var player = {score: 1, name: 'Jeff'};
player.score = 2;
// player ä¿®æ”¹åçš„å€¼ä¸º {score: 2, name: 'Jeff'}
```

#### æ–°æ•°æ®æ›¿æ¢æ—§æ•°æ®

```
var player = {score: 1, name: 'Jeff'};

var newPlayer = Object.assign({}, player, {score: 2});
// player çš„å€¼æ²¡æœ‰æ”¹å˜, ä½†æ˜¯ newPlayer çš„å€¼æ˜¯ {score: 2, name: 'Jeff'}

// ä½¿ç”¨å¯¹è±¡å±•å¼€è¯­æ³•ï¼Œå°±å¯ä»¥å†™æˆï¼š
// var newPlayer = {...player, score: 2};
```

ä¸ç›´æ¥ä¿®æ”¹ï¼ˆæˆ–æ”¹å˜åº•å±‚æ•°æ®ï¼‰è¿™ç§æ–¹å¼å’Œå‰ä¸€ç§æ–¹å¼çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œè¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç‚¹å¥½å¤„ï¼š

#### ç®€åŒ–å¤æ‚çš„åŠŸèƒ½

ä¸å¯å˜æ€§ä½¿å¾—å¤æ‚çš„ç‰¹æ€§æ›´å®¹æ˜“å®ç°ã€‚åœ¨åé¢çš„ç« èŠ‚é‡Œï¼Œæˆ‘ä»¬ä¼šå®ç°ä¸€ç§å«åšâ€œæ—¶é—´æ—…è¡Œâ€çš„åŠŸèƒ½ã€‚â€œæ—¶é—´æ—…è¡Œâ€å¯ä»¥ä½¿æˆ‘ä»¬å›é¡¾äº•å­—æ£‹çš„å†å²æ­¥éª¤ï¼Œå¹¶ä¸”å¯ä»¥â€œè·³å›â€ä¹‹å‰çš„æ­¥éª¤ã€‚è¿™ä¸ªåŠŸèƒ½å¹¶ä¸æ˜¯åªæœ‰æ¸¸æˆæ‰ä¼šç”¨åˆ°â€”â€”æ’¤é”€å’Œæ¢å¤åŠŸèƒ½åœ¨å¼€å‘ä¸­æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ã€‚ä¸ç›´æ¥åœ¨æ•°æ®ä¸Šä¿®æ”¹å¯ä»¥è®©æˆ‘ä»¬è¿½æº¯å¹¶å¤ç”¨æ¸¸æˆçš„å†å²è®°å½•ã€‚

#### è·Ÿè¸ªæ•°æ®çš„æ”¹å˜

å¦‚æœç›´æ¥ä¿®æ”¹æ•°æ®ï¼Œé‚£ä¹ˆå°±å¾ˆéš¾è·Ÿè¸ªåˆ°æ•°æ®çš„æ”¹å˜ã€‚è·Ÿè¸ªæ•°æ®çš„æ”¹å˜éœ€è¦å¯å˜å¯¹è±¡å¯ä»¥ä¸æ”¹å˜ä¹‹å‰çš„ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ï¼Œè¿™æ ·æ•´ä¸ªå¯¹è±¡æ ‘éƒ½éœ€è¦è¢«éå†ä¸€æ¬¡ã€‚

è·Ÿè¸ªä¸å¯å˜æ•°æ®çš„å˜åŒ–ç›¸å¯¹æ¥è¯´å°±å®¹æ˜“å¤šäº†ã€‚å¦‚æœå‘ç°å¯¹è±¡å˜æˆäº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¯´å¯¹è±¡å‘ç”Ÿæ”¹å˜äº†ã€‚

#### ç¡®å®šåœ¨ React ä¸­ä½•æ—¶é‡æ–°æ¸²æŸ“

ä¸å¯å˜æ€§æœ€ä¸»è¦çš„ä¼˜åŠ¿åœ¨äºå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ React ä¸­åˆ›å»º *pure components*ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„ç¡®å®šä¸å¯å˜æ•°æ®æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œä»è€Œç¡®å®šä½•æ—¶å¯¹ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚

æŸ¥é˜…[æ€§èƒ½ä¼˜åŒ–](https://zh-hans.reactjs.org/docs/optimizing-performance.html#examples)ç« èŠ‚ï¼Œä»¥äº†è§£æ›´å¤šæœ‰å…³ `shouldComponentUpdate()` å‡½æ•°åŠå¦‚ä½•æ„å»º *pure components* çš„å†…å®¹ã€‚

### å‡½æ•°ç»„ä»¶

æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠ Square ç»„ä»¶é‡å†™ä¸ºä¸€ä¸ª**å‡½æ•°ç»„ä»¶**ã€‚

å¦‚æœä½ æƒ³å†™çš„ç»„ä»¶åªåŒ…å«ä¸€ä¸ª `render` æ–¹æ³•ï¼Œå¹¶ä¸”ä¸åŒ…å« stateï¼Œé‚£ä¹ˆä½¿ç”¨**å‡½æ•°ç»„ä»¶**å°±ä¼šæ›´ç®€å•ã€‚æˆ‘ä»¬ä¸éœ€è¦å®šä¹‰ä¸€ä¸ªç»§æ‰¿äº `React.Component` çš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ `props` ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›éœ€è¦æ¸²æŸ“çš„å…ƒç´ ã€‚å‡½æ•°ç»„ä»¶å†™èµ·æ¥å¹¶ä¸åƒ class ç»„ä»¶é‚£ä¹ˆç¹çï¼Œå¾ˆå¤šç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°ç»„ä»¶æ¥å†™ã€‚

æŠŠ Square ç±»æ›¿æ¢æˆä¸‹é¢çš„å‡½æ•°ï¼š

```
function Square(props) {
  return (
    <button className="square" onClick={props.onClick}>
      {props.value}
    </button>
  );
}
```

æˆ‘ä»¬æŠŠä¸¤ä¸ª `this.props` éƒ½æ›¿æ¢æˆäº† `props`ã€‚

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/QvvJOv?editors=0010)**

> æ³¨æ„
>
> å½“æˆ‘ä»¬æŠŠ Square ä¿®æ”¹æˆå‡½æ•°ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬åŒæ—¶ä¹ŸæŠŠ `onClick={() => this.props.onClick()}` æ”¹æˆäº†æ›´çŸ­çš„ `onClick={props.onClick}`ï¼ˆæ³¨æ„ä¸¤ä¾§*éƒ½*æ²¡æœ‰æ‹¬å·ï¼‰ã€‚

### è½®æµè½å­

ç°åœ¨äº•å­—æ£‹è¿˜æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºé™·æœ‰å¾…å®Œå–„ï¼šç›®å‰è¿˜ä¸èƒ½åœ¨æ£‹ç›˜ä¸Šæ ‡è®° â€œOâ€ã€‚

æˆ‘ä»¬å°† â€œXâ€ é»˜è®¤è®¾ç½®ä¸ºå…ˆæ‰‹æ£‹ã€‚ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ Board ç»„ä»¶çš„æ„é€ å‡½æ•°ä¸­çš„åˆå§‹ state æ¥è®¾ç½®é»˜è®¤çš„ç¬¬ä¸€æ­¥æ£‹å­ï¼š

```
class Board extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      squares: Array(9).fill(null),
      xIsNext: true,    };
  }
```

æ£‹å­æ¯ç§»åŠ¨ä¸€æ­¥ï¼Œ`xIsNext`ï¼ˆå¸ƒå°”å€¼ï¼‰éƒ½ä¼šåè½¬ï¼Œè¯¥å€¼å°†ç¡®å®šä¸‹ä¸€æ­¥è½®åˆ°å“ªä¸ªç©å®¶ï¼Œå¹¶ä¸”æ¸¸æˆçš„çŠ¶æ€ä¼šè¢«ä¿å­˜ä¸‹æ¥ã€‚æˆ‘ä»¬å°†é€šè¿‡ä¿®æ”¹ Board ç»„ä»¶çš„ `handleClick` å‡½æ•°æ¥åè½¬ `xIsNext` çš„å€¼ï¼š

```
  handleClick(i) {
    const squares = this.state.squares.slice();
    squares[i] = this.state.xIsNext ? 'X' : 'O';    this.setState({
      squares: squares,
      xIsNext: !this.state.xIsNext,    });
  }
```

ä¿®æ”¹ä¹‹åï¼Œæˆ‘ä»¬å°±å®ç°äº† â€œXâ€ å’Œ â€œOâ€ è½®æµè½å­çš„æ•ˆæœã€‚å°è¯•ç©ä¸€ä¸‹ã€‚

æ¥ä¸‹æ¥ä¿®æ”¹ Board ç»„ä»¶ `render` æ–¹æ³•ä¸­ â€œstatusâ€ çš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾ç¤ºä¸‹ä¸€æ­¥æ˜¯å“ªä¸ªç©å®¶çš„äº†ã€‚

```
  render() {
    const status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');
    return (
      // å…¶ä»–éƒ¨åˆ†æ²¡æœ‰æ”¹å˜
```

ç°åœ¨ä½ æ•´ä¸ªçš„ Board ç»„ä»¶çš„ä»£ç åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š

```
class Board extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      squares: Array(9).fill(null),
      xIsNext: true,    };
  }

  handleClick(i) {
    const squares = this.state.squares.slice();    squares[i] = this.state.xIsNext ? 'X' : 'O';    this.setState({      squares: squares,      xIsNext: !this.state.xIsNext,    });  }

  renderSquare(i) {
    return (
      <Square
        value={this.state.squares[i]}
        onClick={() => this.handleClick(i)}
      />
    );
  }

  render() {
    const status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');
    return (
      <div>
        <div className="status">{status}</div>
        <div className="board-row">
          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
        </div>
        <div className="board-row">
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
        </div>
        <div className="board-row">
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}
        </div>
      </div>
    );
  }
}
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/KmmrBy?editors=0010)**

### åˆ¤æ–­å‡ºèƒœè€…

è‡³æ­¤æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºä¸‹ä¸€æ­¥ä¼šè½®åˆ°å“ªä½ç©å®¶ï¼Œä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ˜¾ç¤ºæ¸¸æˆçš„ç»“æœæ¥åˆ¤å®šæ¸¸æˆç»“æŸã€‚æ‹·è´å¦‚ä¸‹ calculateWinner å‡½æ•°å¹¶ç²˜è´´åˆ°æ–‡ä»¶åº•éƒ¨ï¼š

```
function calculateWinner(squares) {
  const lines = [
    [0, 1, 2],
    [3, 4, 5],
    [6, 7, 8],
    [0, 3, 6],
    [1, 4, 7],
    [2, 5, 8],
    [0, 4, 8],
    [2, 4, 6],
  ];
  for (let i = 0; i < lines.length; i++) {
    const [a, b, c] = lines[i];
    if (squares[a] && squares[a] === squares[b] && squares[a] === squares[c]) {
      return squares[a];
    }
  }
  return null;
}
```

ä¼ å…¥é•¿åº¦ä¸º 9 çš„æ•°ç»„ï¼Œæ­¤å‡½æ•°å°†åˆ¤æ–­å‡ºè·èƒœè€…ï¼Œå¹¶æ ¹æ®æƒ…å†µè¿”å› â€œXâ€ï¼Œâ€œOâ€ æˆ– â€œnullâ€ã€‚

æ¥ç€ï¼Œåœ¨ Board ç»„ä»¶çš„ `render` æ–¹æ³•ä¸­è°ƒç”¨ `calculateWinner(squares)` æ£€æŸ¥æ˜¯å¦æœ‰ç©å®¶èƒœå‡ºã€‚ä¸€æ—¦æœ‰ä¸€æ–¹ç©å®¶èƒœå‡ºï¼Œå°±æŠŠè·èƒœç©å®¶çš„ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥ï¼Œæ¯”å¦‚ï¼Œâ€œèƒœè€…ï¼šXâ€ æˆ–è€…â€œèƒœè€…ï¼šOâ€ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ Board çš„ `render` å‡½æ•°ä¸­çš„ status çš„å®šä¹‰ä¿®æ”¹ä¸ºå¦‚ä¸‹ä»£ç ï¼š

```
  render() {
    const winner = calculateWinner(this.state.squares);    let status;    if (winner) {      status = 'Winner: ' + winner;    } else {      status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');    }
    return (
      // å…¶ä»–éƒ¨åˆ†æ²¡æœ‰ä¿®æ”¹
```

æœ€åï¼Œä¿®æ”¹ `handleClick` äº‹ä»¶ï¼Œå½“æœ‰ç©å®¶èƒœå‡ºæ—¶ï¼Œæˆ–è€…æŸä¸ª Square å·²ç»è¢«å¡«å……æ—¶ï¼Œè¯¥å‡½æ•°ä¸åšä»»ä½•å¤„ç†ç›´æ¥è¿”å›ã€‚

```
  handleClick(i) {
    const squares = this.state.squares.slice();
    if (calculateWinner(squares) || squares[i]) {      return;    }    squares[i] = this.state.xIsNext ? 'X' : 'O';
    this.setState({
      squares: squares,
      xIsNext: !this.state.xIsNext,
    });
  }
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/LyyXgK?editors=0010)**

æ­å–œï¼ç°åœ¨ä½ å·²ç»å®Œæˆäº†äº•å­—æ£‹ï¼é™¤æ­¤ä¹‹å¤–ï¼Œä½ ä¹Ÿå·²ç»æŒæ¡äº† React çš„åŸºæœ¬å¸¸è¯†ã€‚æ‰€ä»¥åšæŒåˆ°è¿™ä¸€æ­¥çš„ä½ æ‰æ˜¯çœŸæ­£çš„èµ¢å®¶å‘€ï¼

## æ—¶é—´æ—…è¡Œ

æ¥ä¸‹æ¥æ˜¯æœ€åä¸€ä¸ªç»ƒä¹ ï¼Œæˆ‘ä»¬å°†å®ç°â€œå›åˆ°è¿‡å»â€çš„åŠŸèƒ½ï¼Œä»è€Œåœ¨æ¸¸æˆé‡Œè·³å›åˆ°å†å²æ­¥éª¤ã€‚

### ä¿å­˜å†å²è®°å½•

å¦‚æœæˆ‘ä»¬ç›´æ¥ä¿®æ”¹äº† `square` æ•°ç»„ï¼Œå®ç°æ—¶é—´æ—…è¡Œå°±ä¼šå˜å¾—å¾ˆæ£˜æ‰‹äº†ã€‚

ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `slice()` å‡½æ•°ä¸ºæ¯ä¸€æ­¥åˆ›å»º `squares` æ•°ç»„çš„å‰¯æœ¬ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªæ•°ç»„[å½“ä½œä¸å¯å˜å¯¹è±¡](https://zh-hans.reactjs.org/tutorial/tutorial.html#why-immutability-is-important)ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæ‰€æœ‰ `squares` æ•°ç»„çš„å†å²ç‰ˆæœ¬éƒ½ä¿å­˜ä¸‹æ¥äº†ï¼Œç„¶åå¯ä»¥åœ¨å†å²çš„æ­¥éª¤ä¸­éšæ„è·³è½¬ã€‚

æˆ‘ä»¬æŠŠå†å²çš„ `squares` æ•°ç»„ä¿å­˜åœ¨å¦ä¸€ä¸ªåä¸º `history` çš„æ•°ç»„ä¸­ã€‚`history` æ•°ç»„ä¿å­˜äº†ä»ç¬¬ä¸€æ­¥åˆ°æœ€åä¸€æ­¥çš„æ‰€æœ‰çš„æ£‹ç›˜çŠ¶æ€ã€‚`history` æ•°ç»„çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

```
history = [
  // ç¬¬ä¸€æ­¥ä¹‹å‰
  {
    squares: [
      null, null, null,
      null, null, null,
      null, null, null,
    ]
  },
  // ç¬¬ä¸€æ­¥ä¹‹å
  {
    squares: [
      null, null, null,
      null, 'X', null,
      null, null, null,
    ]
  },
  // ç¬¬äºŒæ­¥ä¹‹å
  {
    squares: [
      null, null, null,
      null, 'X', null,
      null, null, 'O',
    ]
  },
  // ...
]
```

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šåº”è¯¥åœ¨å“ªä¸€ä¸ªç»„ä»¶é‡Œä¿å­˜ `history` è¿™ä¸ª stateã€‚

### å†æ¬¡æå‡çŠ¶æ€

æˆ‘ä»¬å¸Œæœ›é¡¶å±‚ Game ç»„ä»¶å±•ç¤ºå‡ºä¸€ä¸ªå†å²æ­¥éª¤çš„åˆ—è¡¨ã€‚è¿™ä¸ªåŠŸèƒ½éœ€è¦è®¿é—® `history` çš„æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬æŠŠ `history` è¿™ä¸ª state æ”¾åœ¨é¡¶å±‚ Game ç»„ä»¶ä¸­ã€‚

æˆ‘ä»¬æŠŠ `history` state æ”¾åœ¨äº† Game ç»„ä»¶ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä»å®ƒçš„å­ç»„ä»¶ Board é‡Œé¢åˆ é™¤æ‰ `square` ä¸­çš„ stateã€‚æ­£å¦‚æˆ‘ä»¬æŠŠ Square ç»„ä»¶çš„[çŠ¶æ€æå‡](https://zh-hans.reactjs.org/tutorial/tutorial.html#lifting-state-up)åˆ° Board ç»„ä»¶ä¸€æ ·ï¼Œç°åœ¨æˆ‘ä»¬æ¥æŠŠ state ä» Board ç»„ä»¶æå‡åˆ°é¡¶å±‚çš„ Game ç»„ä»¶é‡Œã€‚è¿™æ ·ï¼ŒGame ç»„ä»¶å°±æ‹¥æœ‰äº†å¯¹ Board ç»„ä»¶æ•°æ®çš„å®Œå…¨æ§åˆ¶æƒï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®© Game ç»„ä»¶æ§åˆ¶ Board ç»„ä»¶ï¼Œå¹¶æ ¹æ® `history` æ¸²æŸ“å†å²æ­¥éª¤ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ Game ç»„ä»¶çš„æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ– stateï¼š

```
class Game extends React.Component {
  constructor(props) {    super(props);    this.state = {      history: [{        squares: Array(9).fill(null),      }],      xIsNext: true,    };  }
  render() {
    return (
      <div className="game">
        <div className="game-board">
          <Board />
        </div>
        <div className="game-info">
          <div>{/* status */}</div>
          <ol>{/* TODO */}</ol>
        </div>
      </div>
    );
  }
}
```

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è®© Board ç»„ä»¶ä» Game ç»„ä»¶ä¸­æ¥æ”¶ `squares` å’Œ `onClick` è¿™ä¸¤ä¸ª propsã€‚å› ä¸ºå½“å‰åœ¨ Board ç»„ä»¶ä¸­å·²ç»æœ‰ä¸€ä¸ªå¯¹ Square ç‚¹å‡»äº‹ä»¶çš„ç›‘å¬å‡½æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠæ¯ä¸€ä¸ª Square çš„å¯¹åº”ä½ç½®ä¼ é€’ç»™ `onClick` ç›‘å¬å‡½æ•°ï¼Œè¿™æ ·ç›‘å¬å‡½æ•°å°±çŸ¥é“å…·ä½“å“ªä¸€ä¸ª Square è¢«ç‚¹å‡»äº†ã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹ Board ç»„ä»¶çš„å‡ ä¸ªå¿…è¦æ­¥éª¤ï¼š

- åˆ é™¤ Board ç»„ä»¶ä¸­çš„ `constructor` æ„é€ å‡½æ•°ã€‚
- æŠŠ Board ç»„ä»¶çš„ `renderSquare` ä¸­çš„ `this.state.squares[i]` æ›¿æ¢ä¸º `this.props.squares[i]`ã€‚
- æŠŠ Board ç»„ä»¶çš„ `renderSquare` ä¸­çš„ `this.handleClick(i)` æ›¿æ¢ä¸º `this.props.onClick(i)`ã€‚

ä¿®æ”¹åçš„ Board ç»„ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š

```
class Board extends React.Component {
  handleClick(i) {
    const squares = this.state.squares.slice();
    if (calculateWinner(squares) || squares[i]) {
      return;
    }
    squares[i] = this.state.xIsNext ? 'X' : 'O';
    this.setState({
      squares: squares,
      xIsNext: !this.state.xIsNext,
    });
  }

  renderSquare(i) {
    return (
      <Square
        value={this.props.squares[i]}        onClick={() => this.props.onClick(i)}      />
    );
  }

  render() {
    const winner = calculateWinner(this.state.squares);
    let status;
    if (winner) {
      status = 'Winner: ' + winner;
    } else {
      status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');
    }

    return (
      <div>
        <div className="status">{status}</div>
        <div className="board-row">
          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
        </div>
        <div className="board-row">
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
        </div>
        <div className="board-row">
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}
        </div>
      </div>
    );
  }
}
```

æ¥ç€ï¼Œæ›´æ–° Game ç»„ä»¶çš„ `render` å‡½æ•°ï¼Œä½¿ç”¨æœ€æ–°ä¸€æ¬¡å†å²è®°å½•æ¥ç¡®å®šå¹¶å±•ç¤ºæ¸¸æˆçš„çŠ¶æ€ï¼š

```
  render() {
    const history = this.state.history;    const current = history[history.length - 1];    const winner = calculateWinner(current.squares);    let status;    if (winner) {      status = 'Winner: ' + winner;    } else {      status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');    }
    return (
      <div className="game">
        <div className="game-board">
          <Board            squares={current.squares}            onClick={(i) => this.handleClick(i)}          />        </div>
        <div className="game-info">
          <div>{status}</div>          <ol>{/* TODO */}</ol>
        </div>
      </div>
    );
  }
```

ç”±äº Game ç»„ä»¶æ¸²æŸ“äº†æ¸¸æˆçš„çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°† Board ç»„ä»¶ `render` æ–¹æ³•ä¸­å¯¹åº”çš„ä»£ç ç§»é™¤ã€‚ä¿®æ”¹ä¹‹åï¼ŒBoard ç»„ä»¶çš„ `render` å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š

```
  render() {    return (      <div>        <div className="board-row">          {this.renderSquare(0)}
          {this.renderSquare(1)}
          {this.renderSquare(2)}
        </div>
        <div className="board-row">
          {this.renderSquare(3)}
          {this.renderSquare(4)}
          {this.renderSquare(5)}
        </div>
        <div className="board-row">
          {this.renderSquare(6)}
          {this.renderSquare(7)}
          {this.renderSquare(8)}
        </div>
      </div>
    );
  }
```

æœ€åï¼Œæˆ‘ä»¬éœ€è¦æŠŠ Board ç»„ä»¶çš„ `handleClick` æ–¹æ³•ç§»åŠ¨ Game ç»„ä»¶ä¸­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¿®æ”¹ä¸€ä¸‹ `handleClick` æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªç»„ä»¶çš„ state åœ¨ç»“æ„ä¸Šæœ‰æ‰€ä¸åŒã€‚åœ¨ Game ç»„ä»¶çš„ `handleClick` æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ–°çš„å†å²è®°å½•æ‹¼æ¥åˆ° `history` ä¸Šã€‚

```
  handleClick(i) {
    const history = this.state.history;    const current = history[history.length - 1];    const squares = current.squares.slice();    if (calculateWinner(squares) || squares[i]) {
      return;
    }
    squares[i] = this.state.xIsNext ? 'X' : 'O';
    this.setState({
      history: history.concat([{        squares: squares,      }]),      xIsNext: !this.state.xIsNext,
    });
  }
```

> æ³¨æ„
>
> `concat()` æ–¹æ³•å¯èƒ½ä¸ä½ æ¯”è¾ƒç†Ÿæ‚‰çš„ `push()` æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼Œå®ƒå¹¶ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¨èä½¿ç”¨ `concat()`ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒBoard ç»„ä»¶åªéœ€è¦ `renderSquare` å’Œ `render` è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è€Œæ¸¸æˆçš„çŠ¶æ€å’Œ `handleClick` æ–¹æ³•åˆ™ä¼šæ”¾åœ¨ Game ç»„ä»¶å½“ä¸­ã€‚

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/EmmOqJ?editors=0010)**

### å±•ç¤ºå†å²æ­¥éª¤è®°å½•

ç”±äºæˆ‘ä»¬å·²ç»è®°å½•äº†äº•å­—æ£‹çš„å†å²è®°å½•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›è®°å½•ä»¥å†å²æ­¥éª¤åˆ—è¡¨çš„å½¢å¼å±•ç¤ºç»™ç©å®¶ã€‚

åœ¨å‰æ–‡ä¸­æåˆ°çš„ React å…ƒç´ è¢«è§†ä¸º JavaScript ä¸€ç­‰å…¬æ°‘ä¸­çš„å¯¹è±¡ï¼ˆfirst-class JavaScript objectsï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠ React å…ƒç´ åœ¨åº”ç”¨ç¨‹åºä¸­å½“ä½œå‚æ•°æ¥ä¼ é€’ã€‚åœ¨ React ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ React å…ƒç´ çš„æ•°ç»„æ¥æ¸²æŸ“å¤šä¸ªå…ƒç´ ã€‚

åœ¨ JavaScript ä¸­ï¼Œæ•°ç»„æ‹¥æœ‰ [`map()` æ–¹æ³•](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)ï¼Œè¯¥æ–¹æ³•é€šå¸¸ç”¨äºæŠŠæŸæ•°ç»„æ˜ å°„ä¸ºå¦ä¸€ä¸ªæ•°ç»„ï¼Œä¾‹å¦‚ï¼š

```
const numbers = [1, 2, 3];
const doubled = numbers.map(x => x * 2); // [2, 4, 6]
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ `map` æ–¹æ³•ï¼ŒæŠŠå†å²æ­¥éª¤æ˜ å°„ä¸ºä»£è¡¨æŒ‰é’®çš„ React å…ƒç´ ï¼Œç„¶åå¯ä»¥å±•ç¤ºå‡ºä¸€ä¸ªæŒ‰é’®çš„åˆ—è¡¨ï¼Œç‚¹å‡»è¿™äº›æŒ‰é’®ï¼Œå¯ä»¥â€œè·³è½¬â€åˆ°å¯¹åº”çš„å†å²æ­¥éª¤ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ Game ç»„ä»¶çš„ `render` æ–¹æ³•ä¸­è°ƒç”¨ `history` çš„ `map` æ–¹æ³•ï¼š

```
  render() {
    const history = this.state.history;
    const current = history[history.length - 1];
    const winner = calculateWinner(current.squares);

    const moves = history.map((step, move) => {      const desc = move ?        'Go to move #' + move :        'Go to game start';      return (        <li>          <button onClick={() => this.jumpTo(move)}>{desc}</button>        </li>      );    });
    let status;
    if (winner) {
      status = 'Winner: ' + winner;
    } else {
      status = 'Next player: ' + (this.state.xIsNext ? 'X' : 'O');
    }

    return (
      <div className="game">
        <div className="game-board">
          <Board
            squares={current.squares}
            onClick={(i) => this.handleClick(i)}
          />
        </div>
        <div className="game-info">
          <div>{status}</div>
          <ol>{moves}</ol>        </div>
      </div>
    );
  }
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/EmmGEa?editors=0010)**

å¯¹äºäº•å­—æ£‹å†å²è®°å½•çš„æ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬éƒ½åˆ›å»ºå‡ºäº†ä¸€ä¸ªåŒ…å«æŒ‰é’® `<button>` å…ƒç´ çš„ `<li>` çš„åˆ—è¡¨ã€‚è¿™äº›æŒ‰é’®æ‹¥æœ‰ä¸€ä¸ª `onClick` äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°é‡Œè°ƒç”¨äº† `this.jumpTo()` æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç° `jumpTo()` æ–¹æ³•ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ¸¸æˆå†å²æ­¥éª¤çš„åˆ—è¡¨ï¼Œä»¥åŠå¼€å‘è€…å·¥å…·æ§åˆ¶å°çš„è­¦å‘Šä¿¡æ¯ï¼Œè­¦å‘Šä¿¡æ¯å¦‚ä¸‹ï¼š

> Warning: Each child in an array or iterator should have a unique â€œkeyâ€ prop. Check the render method of â€œGameâ€.

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¸Šé¢çš„è­¦å‘Šä¿¡æ¯æ˜¯ä»€ä¹ˆæ„æ€ã€‚

### é€‰æ‹©ä¸€ä¸ª key

å½“æˆ‘ä»¬éœ€è¦æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨çš„æ—¶å€™ï¼ŒReact ä¼šå­˜å‚¨è¿™ä¸ªåˆ—è¡¨æ¯ä¸€é¡¹çš„ç›¸å…³ä¿¡æ¯ã€‚å½“æˆ‘ä»¬è¦æ›´æ–°è¿™ä¸ªåˆ—è¡¨æ—¶ï¼ŒReact éœ€è¦ç¡®å®šå“ªäº›é¡¹å‘ç”Ÿäº†æ”¹å˜ã€‚æˆ‘ä»¬æœ‰å¯èƒ½å¢åŠ ã€åˆ é™¤ã€é‡æ–°æ’åºæˆ–è€…æ›´æ–°åˆ—è¡¨é¡¹ã€‚

æƒ³è±¡ä¸€ä¸‹æŠŠä¸‹é¢çš„ä»£ç 

```
<li>Alexa: 7 tasks left</li>
<li>Ben: 5 tasks left</li>
```

è½¬æ¢æˆä¸‹é¢çš„ä»£ç 

```
<li>Ben: 9 tasks left</li>
<li>Claudia: 8 tasks left</li>
<li>Alexa: 5 tasks left</li>
```

é™¤äº†æ•°å­—å‘ç”Ÿäº†æ”¹å˜ä¹‹å¤–ï¼Œé˜…è¯»è¿™æ®µä»£ç çš„äººä¹Ÿè®¸ä¼šè®¤ä¸ºæˆ‘ä»¬æŠŠ Alexa å’Œ Ben çš„é¡ºåºäº¤æ¢äº†ä½ç½®ï¼Œç„¶åæŠŠ Claudia æ’å…¥åˆ° Alexa å’Œ Ben ä¹‹é—´ã€‚ç„¶è€Œï¼ŒReact æ˜¯ç”µè„‘ç¨‹åºï¼Œå®ƒå¹¶ä¸çŸ¥é“æˆ‘ä»¬æƒ³è¦ä»€ä¹ˆã€‚å› ä¸º React æ— æ³•å¾—çŸ¥æˆ‘ä»¬äººç±»çš„æ„å›¾ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™æ¯ä¸€ä¸ªåˆ—è¡¨é¡¹ä¸€ä¸ªç¡®å®šçš„ *key* å±æ€§ï¼Œå®ƒå¯ä»¥ç”¨æ¥åŒºåˆ†ä¸åŒçš„åˆ—è¡¨é¡¹å’Œä»–ä»¬çš„åŒçº§å…„å¼Ÿåˆ—è¡¨é¡¹ã€‚ä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ `alexa`, `ben`, `claudia`ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ä»æ•°æ®åº“é‡Œè·å–çš„æ•°æ®ï¼Œé‚£ä¹ˆ Alexaã€Ben å’Œ Claudia çš„æ•°æ®åº“ ID å°±å¯ä»¥ä½œä¸º key æ¥ä½¿ç”¨ã€‚

```
<li key={user.id}>{user.name}: {user.taskCount} tasks left</li>
```

æ¯å½“ä¸€ä¸ªåˆ—è¡¨é‡æ–°æ¸²æŸ“æ—¶ï¼ŒReact ä¼šæ ¹æ®æ¯ä¸€é¡¹åˆ—è¡¨å…ƒç´ çš„ key æ¥æ£€ç´¢ä¸Šä¸€æ¬¡æ¸²æŸ“æ—¶ä¸æ¯ä¸ª key æ‰€åŒ¹é…çš„åˆ—è¡¨é¡¹ã€‚å¦‚æœ React å‘ç°å½“å‰çš„åˆ—è¡¨æœ‰ä¸€ä¸ªä¹‹å‰ä¸å­˜åœ¨çš„ keyï¼Œé‚£ä¹ˆå°±ä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚å¦‚æœ React å‘ç°å’Œä¹‹å‰å¯¹æ¯”å°‘äº†ä¸€ä¸ª keyï¼Œé‚£ä¹ˆå°±ä¼šé”€æ¯ä¹‹å‰å¯¹åº”çš„ç»„ä»¶ã€‚å¦‚æœä¸€ä¸ªç»„ä»¶çš„ key å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™ä¸ªç»„ä»¶ä¼šè¢«é”€æ¯ï¼Œç„¶åä½¿ç”¨æ–°çš„ state é‡æ–°åˆ›å»ºä¸€ä»½ã€‚

`key` æ˜¯ React ä¸­ä¸€ä¸ªç‰¹æ®Šçš„ä¿ç•™å±æ€§ï¼ˆè¿˜æœ‰ä¸€ä¸ªæ˜¯ `ref`ï¼Œæ‹¥æœ‰æ›´é«˜çº§çš„ç‰¹æ€§ï¼‰ã€‚å½“ React å…ƒç´ è¢«åˆ›å»ºå‡ºæ¥çš„æ—¶å€™ï¼ŒReact ä¼šæå–å‡º `key` å±æ€§ï¼Œç„¶åæŠŠ key ç›´æ¥å­˜å‚¨åœ¨è¿”å›çš„å…ƒç´ ä¸Šã€‚è™½ç„¶ `key` çœ‹èµ·æ¥å¥½åƒæ˜¯ `props` ä¸­çš„ä¸€ä¸ªï¼Œä½†æ˜¯ä½ ä¸èƒ½é€šè¿‡ `this.props.key` æ¥è·å– `key`ã€‚React ä¼šé€šè¿‡ `key` æ¥è‡ªåŠ¨åˆ¤æ–­å“ªäº›ç»„ä»¶éœ€è¦æ›´æ–°ã€‚ç»„ä»¶æ˜¯ä¸èƒ½è®¿é—®åˆ°å®ƒçš„ `key` çš„ã€‚

**æˆ‘ä»¬å¼ºçƒˆæ¨èï¼Œæ¯æ¬¡åªè¦ä½ æ„å»ºåŠ¨æ€åˆ—è¡¨çš„æ—¶å€™ï¼Œéƒ½è¦æŒ‡å®šä¸€ä¸ªåˆé€‚çš„ keyã€‚**å¦‚æœä½ æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ keyï¼Œé‚£ä¹ˆä½ å°±éœ€è¦è€ƒè™‘é‡æ–°æ•´ç†ä½ çš„æ•°æ®ç»“æ„äº†ï¼Œè¿™æ ·æ‰èƒ½æœ‰åˆé€‚çš„ keyã€‚

å¦‚æœä½ æ²¡æœ‰æŒ‡å®šä»»ä½• keyï¼ŒReact ä¼šå‘å‡ºè­¦å‘Šï¼Œå¹¶ä¸”ä¼šæŠŠæ•°ç»„çš„ç´¢å¼•å½“ä½œé»˜è®¤çš„ keyã€‚ä½†æ˜¯å¦‚æœæƒ³è¦å¯¹åˆ—è¡¨è¿›è¡Œé‡æ–°æ’åºã€æ–°å¢ã€åˆ é™¤æ“ä½œæ—¶ï¼ŒæŠŠæ•°ç»„ç´¢å¼•ä½œä¸º key æ˜¯æœ‰é—®é¢˜çš„ã€‚æ˜¾å¼åœ°ä½¿ç”¨ `key={i}` æ¥æŒ‡å®š key ç¡®å®ä¼šæ¶ˆé™¤è­¦å‘Šï¼Œä½†æ˜¯ä»ç„¶å’Œæ•°ç»„ç´¢å¼•å­˜åœ¨åŒæ ·çš„é—®é¢˜ï¼Œæ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¥½ä¸è¦è¿™ä¹ˆåšã€‚

ç»„ä»¶çš„ key å€¼å¹¶ä¸éœ€è¦åœ¨å…¨å±€éƒ½ä¿è¯å”¯ä¸€ï¼Œåªéœ€è¦åœ¨å½“å‰çš„åŒä¸€çº§å…ƒç´ ä¹‹å‰ä¿è¯å”¯ä¸€å³å¯ã€‚

### å®ç°æ—¶é—´æ—…è¡Œ

åœ¨äº•å­—æ£‹çš„å†å²è®°å½•ä¸­ï¼Œæ¯ä¸€ä¸ªå†å²æ­¥éª¤éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„å”¯ä¸€ IDï¼šè¿™ä¸ª ID å°±æ˜¯æ¯ä¸€æ­¥æ£‹çš„åºå·ã€‚å› ä¸ºå†å²æ­¥éª¤ä¸éœ€è¦é‡æ–°æ’åºã€æ–°å¢ã€åˆ é™¤ï¼Œæ‰€ä»¥ä½¿ç”¨æ­¥éª¤çš„ç´¢å¼•ä½œä¸º `key` æ˜¯å®‰å…¨çš„ã€‚

åœ¨ Game ç»„ä»¶çš„ `render` æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ·»åŠ  keyï¼Œ`<li key={move}>`ï¼Œè¿™æ ·å…³äº key çš„è­¦å‘Šå°±ä¼šæ¶ˆå¤±äº†ã€‚

```
    const moves = history.map((step, move) => {
      const desc = move ?
        'Go to move #' + move :
        'Go to game start';
      return (
        <li key={move}>          <button onClick={() => this.jumpTo(move)}>{desc}</button>
        </li>
      );
    });
```

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/PmmXRE?editors=0010)**

å› ä¸º `jumpTo` è¿˜æœªå®šä¹‰ï¼Œæ‰€ä»¥ä½ ç‚¹å‡»åˆ—è¡¨é¡¹çš„æŒ‰é’®æ—¶ï¼Œä¼šå‡ºç°æŠ¥é”™ã€‚åœ¨æˆ‘ä»¬å®ç° `jumpTo` ä¹‹å‰ï¼Œæˆ‘ä»¬å‘ Game ç»„ä»¶çš„ state ä¸­æ·»åŠ  `stepNumber`ï¼Œè¿™ä¸ªå€¼ä»£è¡¨æˆ‘ä»¬å½“å‰æ­£åœ¨æŸ¥çœ‹å“ªä¸€é¡¹å†å²è®°å½•ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ Game çš„æ„é€ å‡½æ•° `constructor` ä¸­å‘åˆå§‹ state ä¸­æ·»åŠ  `stepNumber: 0`ï¼š

```
class Game extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      history: [{
        squares: Array(9).fill(null),
      }],
      stepNumber: 0,      xIsNext: true,
    };
  }
```

ç„¶åï¼Œæˆ‘ä»¬åœ¨ Game ç»„ä»¶ä¸­å®šä¹‰ `jumpTo` æ–¹æ³•ä»¥æ›´æ–°çŠ¶æ€ `stepNumber`ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå½“çŠ¶æ€ `stepNumber` æ˜¯å¶æ•°æ—¶ï¼Œæˆ‘ä»¬è¿˜è¦æŠŠ `xIsNext` è®¾ä¸º trueï¼š

```
  handleClick(i) {
    // è¿™ä¸ªæ–¹æ³•æ— æ›´æ”¹
  }

  jumpTo(step) {    this.setState({      stepNumber: step,      xIsNext: (step % 2) === 0,    });  }
  render() {
    // è¿™ä¸ªæ–¹æ³•æ— æ›´æ”¹
  }
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜è¦ä¿®æ”¹ Game ç»„ä»¶çš„ `handleClick` æ–¹æ³•ï¼Œå½“ä½ ç‚¹å‡»æ–¹æ ¼çš„æ—¶å€™è§¦å‘è¯¥æ–¹æ³•ã€‚

æ–°æ·»åŠ çš„ `stepNumber` state ç”¨äºç»™ç”¨æˆ·å±•ç¤ºå½“å‰çš„æ­¥éª¤ã€‚æ¯å½“æˆ‘ä»¬è½ä¸‹ä¸€é¢—æ–°æ£‹å­çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ `this.setState` å¹¶ä¼ å…¥å‚æ•° `stepNumber: history.length`ï¼Œä»¥æ›´æ–° `stepNumber`ã€‚è¿™å°±ä¿è¯äº†ä¿è¯æ¯èµ°ä¸€æ­¥ `stepNumber` ä¼šè·Ÿç€æ”¹å˜ã€‚

æˆ‘ä»¬è¿˜æŠŠè¯»å– `this.state.history` æ¢æˆäº†è¯»å– `this.state.history.slice(0, this.state.stepNumber + 1)` çš„å€¼ã€‚å¦‚æœæˆ‘ä»¬â€œå›åˆ°è¿‡å»â€ï¼Œç„¶åå†èµ°ä¸€æ­¥æ–°æ£‹å­ï¼ŒåŸæ¥çš„â€œæœªæ¥â€å†å²è®°å½•å°±ä¸æ­£ç¡®äº†ï¼Œè¿™ä¸ªæ›¿æ¢å¯ä»¥ä¿è¯æˆ‘ä»¬æŠŠè¿™äº›â€œæœªæ¥â€çš„ä¸æ­£ç¡®çš„å†å²è®°å½•ä¸¢å¼ƒæ‰ã€‚

```
  handleClick(i) {
    const history = this.state.history.slice(0, this.state.stepNumber + 1);    const current = history[history.length - 1];
    const squares = current.squares.slice();
    if (calculateWinner(squares) || squares[i]) {
      return;
    }
    squares[i] = this.state.xIsNext ? 'X' : 'O';
    this.setState({
      history: history.concat([{
        squares: squares
      }]),
      stepNumber: history.length,      xIsNext: !this.state.xIsNext,
    });
  }
```

æœ€åï¼Œä¿®æ”¹ Game ç»„ä»¶çš„ `render` æ–¹æ³•ï¼Œå°†ä»£ç ä»å§‹ç»ˆæ ¹æ®æœ€åä¸€æ¬¡ç§»åŠ¨æ¸²æŸ“ä¿®æ”¹ä¸ºæ ¹æ®å½“å‰ `stepNumber` æ¸²æŸ“ã€‚

```
  render() {
    const history = this.state.history;
    const current = history[this.state.stepNumber];    const winner = calculateWinner(current.squares);

    // å…¶ä»–éƒ¨åˆ†æ²¡æœ‰æ”¹å˜
```

å¦‚æœæˆ‘ä»¬ç‚¹å‡»æ¸¸æˆå†å²è®°å½•çš„ä»»ä½•ä¸€æ­¥ï¼Œäº•å­—æ£‹çš„æ£‹ç›˜å°±ä¼šç«‹å³æ›´æ–°ä¸ºåˆšèµ°é‚£ä¸€æ­¥æ£‹æ—¶å€™çš„æ ·å­ã€‚

**[æŸ¥çœ‹æ­¤æ­¥å®Œæ•´ä»£ç ç¤ºä¾‹](https://codepen.io/gaearon/pen/gWWZgR?editors=0010)**

### æ€»ç»“

æ­å–œä½ ï¼ä½ å·²ç»å®Œæˆäº†ä¸€ä¸ªæ‹¥æœ‰ä»¥ä¸‹åŠŸèƒ½çš„äº•å­—æ£‹å•¦ï¼š

- tic-tac-toe(ä¸‰è¿æ£‹)æ¸¸æˆçš„æ‰€æœ‰åŠŸèƒ½
- èƒ½å¤Ÿåˆ¤å®šç©å®¶ä½•æ—¶è·èƒœ
- èƒ½å¤Ÿè®°å½•æ¸¸æˆè¿›ç¨‹
- å…è®¸ç©å®¶æŸ¥çœ‹æ¸¸æˆçš„å†å²è®°å½•ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹ä»»æ„ä¸€ä¸ªå†å²ç‰ˆæœ¬çš„æ¸¸æˆæ£‹ç›˜çŠ¶æ€

å¹²çš„ä¸é”™ï¼æˆ‘ä»¬å¸Œæœ›ä½ è‡³æ­¤å·²ç»åŸºæœ¬æŒæ¡äº† React çš„ä½¿ç”¨ã€‚

åœ¨è¿™é‡Œå¯ä»¥æŸ¥çœ‹æœ€ç»ˆçš„æ¸¸æˆä»£ç :**[æœ€ç»ˆæˆæœ](https://codepen.io/gaearon/pen/gWWZgR?editors=0010)**.

å¦‚æœä½ è¿˜æœ‰å……è£•çš„æ—¶é—´ï¼Œæˆ–è€…æƒ³ç»ƒä¹ ä¸€ä¸‹åˆšåˆšå­¦ä¼šçš„ React æ–°æŠ€èƒ½ï¼Œè¿™é‡Œæœ‰ä¸€äº›å¯ä»¥æ”¹è¿›æ¸¸æˆçš„æƒ³æ³•ä¾›ä½ å‚è€ƒï¼Œè¿™äº›åŠŸèƒ½çš„å®ç°é¡ºåºçš„éš¾åº¦æ˜¯é€’å¢çš„ï¼š

1. åœ¨æ¸¸æˆå†å²è®°å½•åˆ—è¡¨æ˜¾ç¤ºæ¯ä¸€æ­¥æ£‹çš„åæ ‡ï¼Œæ ¼å¼ä¸º (åˆ—å·, è¡Œå·)ã€‚
2. åœ¨å†å²è®°å½•åˆ—è¡¨ä¸­åŠ ç²—æ˜¾ç¤ºå½“å‰é€‰æ‹©çš„é¡¹ç›®ã€‚
3. ä½¿ç”¨ä¸¤ä¸ªå¾ªç¯æ¥æ¸²æŸ“å‡ºæ£‹ç›˜çš„æ ¼å­ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç é‡Œå†™æ­»ï¼ˆhardcodeï¼‰ã€‚
4. æ·»åŠ ä¸€ä¸ªå¯ä»¥å‡åºæˆ–é™åºæ˜¾ç¤ºå†å²è®°å½•çš„æŒ‰é’®ã€‚
5. æ¯å½“æœ‰äººè·èƒœæ—¶ï¼Œé«˜äº®æ˜¾ç¤ºè¿æˆä¸€çº¿çš„ 3 é¢—æ£‹å­ã€‚
6. å½“æ— äººè·èƒœæ—¶ï¼Œæ˜¾ç¤ºä¸€ä¸ªå¹³å±€çš„æ¶ˆæ¯ã€‚

é€šè¿‡è¿™ç¯‡æ•™ç¨‹ï¼Œæˆ‘ä»¬æ¥è§¦äº† React ä¸­çš„ä¸€äº›æ¦‚å¿µï¼Œæ¯”å¦‚ React å…ƒç´ ã€React ç»„ä»¶ã€propsï¼Œè¿˜æœ‰ stateã€‚æ›´å¤šå…³äºè¿™äº›æ¦‚å¿µçš„ç»†èŠ‚çš„è§£é‡Šï¼Œå‚è€ƒ[æ–‡æ¡£çš„å…¶ä»–éƒ¨åˆ†](https://zh-hans.reactjs.org/docs/hello-world.html)ã€‚äº†è§£æ›´å¤šå…³äºç»„ä»¶å®šä¹‰çš„å†…å®¹ï¼Œå‚è€ƒ[`React.Component` API reference](https://zh-hans.reactjs.org/docs/react-component.html)ã€‚

---

[^åŸæ•™ç¨‹åœ°å€]: https://zh-hans.reactjs.org/tutorial/tutorial.html